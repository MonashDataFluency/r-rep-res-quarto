






<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2023-10-06 09:39:07 +1100">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />
     <link rel="stylesheet" type="text/css" href="../assets/css/fonts.css" />
    
    <link rel="license" href="#license-info" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/incubator/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/incubator/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/incubator/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/incubator/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/incubator/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/incubator/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/incubator/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/incubator/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/incubator/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/incubator/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/incubator/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/incubator/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/incubator/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="The Carpentries Incubator - Introduction to Reproducible Publications with RStudio (modified)"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/incubator/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/incubator/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/incubator/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/incubator/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/incubator/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
  <title>
  Introduction to Reproducible Publications with RStudio (modified)
  </title>

  </head>
  <body>
    













    <div class="container">
      
















  
  










<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="../index.html" class="pull-left">
        <img class="navbar-logo" src="../assets/img/incubator-logo-blue.svg" alt="The Carpentries Incubator logo" />
      </a>
      

      
      <a class="navbar-brand" href="../index.html">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            
            <li><a href="../01-introduction/index.html">Scientific reproducibility: What is it for?</a></li>
            
            
            <li><a href="../02-basic-rstudio/index.html">Navigating RStudio and Quarto Documents</a></li>
            
            
            <li><a href="../03-quarto-documents/index.html">Introduction to Working with Quarto documents</a></li>
            
            
            <li><a href="../04-good-project/index.html">Good Practices for Managing Projects in RStudio</a></li>
            
            
            <li><a href="../05-setup-versioning/index.html">Getting Your project set up with Version Control in RStudio</a></li>
            
            
            <li><a href="../06-writing-styling/index.html">Writing and Styling Qmd Documents</a></li>
            
            
            <li><a href="../07-plots-figures/index.html">Adding Code-Generated Plots and Figures</a></li>
            
            
            <li><a href="../08-code-chunks/index.html">Reproducible & Efficient Methods of Using Code Chunks</a></li>
            
            
            <li><a href="../09-biblio-crossref/index.html">Bibliography, Citations & Cross-Referencing</a></li>
            
            
            <li><a href="../10-github/index.html">Collaborating via Github</a></li>
            
            
            <li><a href="../11-publishing-your-project/index.html">Publishing your project</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio/index.html">All in one page (Beta)</a></li>
          </ul>
        </li>
        
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            
            
              <li><a href="../about/index.html">About</a></li>
            
            
            
            
              <li><a href="../discuss/index.html">Discussion</a></li>
            
            
            
            
              <li><a href="../figures/index.html">Figures</a></li>
            
            
            
            
              <li><a href="../guide/index.html">Instructor Notes</a></li>
            
            
          </ul>
        </li>
	

	
        <li><a href="../LICENSE.html">License</a></li>
	
	<li><a href="/edit//aio.md" data-checker-ignore>Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>

      


<div class="alert alert-info text-center" role="alert">
  This lesson is part of
  <a href="https://github.com/carpentries-incubator/proposals/#the-carpentries-incubator" data-checker-ignore>
    The Carpentries Incubator</a>, a place to share and use each other's
  Carpentries-style lessons. <strong>This lesson has not been reviewed by and is
  not endorsed by The Carpentries</strong>.
</div>




      





<h1 class="maintitle"><a href="../index.html">Introduction to Reproducible Publications with RStudio (modified)</a></h1>



<article>

<h1 id="scientific-reproducibility-what-is-it-for" class="maintitle">Scientific reproducibility: What is it for?</h1>

<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 15 min
      <br />
      <strong>Exercises:</strong> 5 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>What is reproducible research?</p>
</li>
	
	<li><p>How can RStudio help research to be more reproducible?</p>
</li>
	
	<li><p>What are the benefits of using RStudio for writing academic essays and papers?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Understand what scientific reproducibility entails.</p>
</li>
	
	<li><p>Identify the benefits of using RStudio to create research reports.</p>
</li>
	
	<li><p>Understand how RStudio supports Open Science principles.</p>
</li>
	
	<li><p>Learn how RStudio can help one’s research.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="warm-up">Warm-up</h2>

<p>Let’s discuss:
What is reproducible research for you?
Have you ever experienced issues while trying to reproduce someone else’s study or even your own research?</p>

<p>Reproducible studies allow other researchers to perform the same processes and analyses to produce an identical result as the first initial researcher. Original researchers have to make available the study’s associated data, documentation, and code pipelines and workflows in a way that is sufficiently self-explanatory and well-documented so that independent investigators can reproduce/recreate the original study under the same conditions, using identical materials and procedures, and ultimately achieve consistent results and render equal outcomes. Original investigators, therefore, must produce rich and detailed documentation for themselves and others. This includes fully specifying both in human-readable and computer-executable ways all steps taken in the study.</p>

<h2 id="the-importance-of-reproducibility-in-research">The importance of Reproducibility in Research</h2>

<p><img src="../fig/01-fig1.png" alt="PhD Comics cartoon" /></p>
<blockquote>
  <p>Source: Comic number <a href="https://phdcomics.com/comics.php?f=1689">1869</a> from <a href="https://phdcomics.com/">PhD Comics</a> Copyrighted artwork by Jorge Cham.</p>
</blockquote>

<h3 id="discussion-a-scary-anecdote">Discussion: A scary anecdote</h3>

<ul>
  <li>A group of researchers obtain great results and submit their work to a high-profile journal.</li>
  <li>Reviewers ask for new figures and additional analysis.</li>
  <li>The researchers start working on revisions and generate modified figures, but find inconsistencies with old figures.</li>
  <li>The researchers can’t find some of the data they used to generate the original results, and can’t figure out which parameters they used when running their analyses.</li>
  <li>The manuscript is still languishing in the drawer…</li>
</ul>

<p>According to the <a href="https://www.nsf.gov/sbe/AC_Materials/SBE_Robust_and_Reliable_Research_Report.pdf">U.S. National Science Foundation (NSF)</a> subcommittee on replicability in science (2015):</p>

<p>Science should routinely evaluate the reproducibility of findings that enjoy a prominent role in the published literature. To make reproduction possible, efficient, and informative, researchers should sufficiently document the details of the procedures used to collect data, to convert observations into analyzable data, and to perform data analysis.</p>

<p>Reproducibility refers to the ability of a researcher to duplicate the results of a prior study using the same materials as were used by the original investigator. That is, a second researcher might use the same raw data to build the same analysis files and implement the same statistical analysis in an attempt to yield the same results. Reproducibility is a minimum necessary condition for a finding to be considered rigorous, believable and informative.</p>

<h3 id="why-all-the-talk-about-reproducible-research">Why all the talk about reproducible research?</h3>

<p>Many studies claim results that cannot be reproduced. This problem has attracted increased attention in recent years, with supporting evidence that research is often not reproducible. A 2016 survey in Nature revealed that irreproducible experiments are a problem across all domains of science:</p>

<p><img src="../fig/01-fig2.png" alt="Nature Report - 2016" /></p>
<blockquote>
  <p>Source: Baker, M. 1,500 scientists lift the lid on reproducibility. Nature 533, 452–454 (2016). <a href="https://doi.org/10.1038/533452a">doi.org/10.1038/533452a</a></p>
</blockquote>

<h2 id="factors-behind-irreproducible-research">Factors behind irreproducible research</h2>

<p><img src="../fig/01-fig3.png" alt="Science is not a miracle" /></p>
<blockquote>
  <p>Source: Then a Miracle Occurs. Copyrighted artwork by Sydney Harris Inc.</p>
</blockquote>

<ul>
  <li>Not enough documentation on how experiment is conducted and data is generated</li>
  <li>Data used to generate original results unavailable</li>
  <li>Software used to generate original results unavailable</li>
  <li>Difficult to recreate software environment (libraries, versions) used to generate original results</li>
  <li>Difficult to rerun the computational steps</li>
</ul>

<h3 id="reproducible-replicable-robust-generalizable">Reproducible, replicable, robust, generalizable</h3>

<p>While reproducibility is the minimum requirement and can be solved with “good enough” computational practices, replicability/robustness/generalizability of scientific findings are an even greater concern involving research misconduct, questionable research practices (p-hacking, HARKing, cherry-picking), sloppy methods, and other conscious and unconscious biases.</p>

<p><img src="../fig/01-fig4.png" alt="How science should be" /></p>
<blockquote>
  <p>Source: This image was created by Scriberia for The Turing Way community DOI: <a href="https://doi.org/10.5281/zenodo.3695300">10.5281/zenodo.3
332807</a></p>
</blockquote>

<p>If contributing to science and other researchers seems not to be compelling enough, here are 5 selfish reasons to work reproducibly according to <a href="https://doi.org/10.1186/s13059-015-0850-7">Markowetz (2015)</a>:</p>

<ul>
  <li>Helps to avoid data loss and disaster</li>
  <li>Makes it easier to write papers</li>
  <li>Helps reviewers see it your way</li>
  <li>Enables continuity of your work</li>
  <li>Helps to build your reputation</li>
</ul>

<h3 id="when-do-you-need-to-worry-about-reproducibility">When do you need to worry about reproducibility?</h3>

<p>Let’s assume that I have convinced you that reproducibility and transparency are in your own best interest. Then what is the best time to worry about it?</p>

<p>From day one, and throughout the whole research life cycle! Before you start the project because you might have to learn tools like R or Git. While you do the analysis because if you wait too long you might lose a lot of time trying to remember what you did two months ago. When you write the paper because you want your numbers, tables, and figures to be up-to-date. When you co-author a paper, because you want to make sure that the analyses presented in a paper with your name on are sound. When you review a paper, because you can’t judge the results if you don’t know how the authors got there.</p>

<p><a href="https://tellingstorieswithdata.com/">Alexander (2022)</a> suggests three steps towards better reproducibility:</p>

<p>1) Ensure the entire workflow is documented. This may involve addressing questions such as:</p>
<ul>
  <li>How was the raw dataset obtained and is access likely to be persistent and available to others?</li>
  <li>What specific steps are being taken to transform the raw data in the data that were analyzed, and how can this be made available to others?</li>
  <li>What analysis has been done, which codes/scripts were used and how clearly can this be shared?</li>
  <li>How has the final paper or report been built and to what extent can others follow that process themselves?</li>
</ul>

<p>2) Try to accomplish progressively with the following requirements:</p>
<ul>
  <li>Can you run your entire workflow again?</li>
  <li>Can another person run your entire workflow again?</li>
  <li>Can “future-you” run your entire workflow again?</li>
  <li>Can “future-another-person” run your entire workflow again?</li>
</ul>

<p>3) Include a discussion about the limitations of the dataset, methods and workflows in the final paper or report.</p>

<h3 id="levels-of-reproducibility">Levels of Reproducibility</h3>

<figure>
<img src="../fig/01-fig5.png" width="400" height="300" />
</figure>

<!--![Levels of Reproducibility](../fig/01-fig5.png){width=50%}-->

<p>A published article is like the top of a pyramid, meaning that a reproducible paper/report rests on multiple levels that each contributes to its reproducibility.</p>

<h2 id="advantages-of-using-rstudio-for-your-project">Advantages of using RStudio for your project</h2>

<p>Understanding foundational aspects of RStudio enables a gradual improvement of scientific workflows and therefore, contributes to increasing research reproducibility compliance. RStudio is an integrated development environment (IDE) for R and Python. It includes a console, syntax-highlighting editor that supports direct code execution, as well as tools for plotting, history, debugging, collaboration, and workspace management. It is a powerful tool which supports research by weaving the principles of reproducibility throughout the entire research lifecycle, from data gathering to the statistical analysis, presentation and publication of results.</p>

<p>RStudio is soon becoming <a href="https://posit.co/">Posit</a>, but that won’t change how you interact with the interface and its functionalities. This name change is only a re-branding to better represent the broader focus and larger community that the IDE serves, which is no longer exclusively linked to R.</p>

<h3 id="it-is-free-and-open-source">It is free and open-source</h3>

<p>Reproducibility becomes more difficult and opaque when results rely on proprietary software. Unless research code is open sourced, reproducing results on different software/hardware configurations is impossible. Rstudio is dedicated to sustainable investment in free and open-source software for data science.</p>

<h3 id="it-is-designed-to-make-it-easy-to-write-and-reuse-code">It is designed to make it easy to write and reuse code</h3>

<p>As soon as you create a new script, the windows/panes within your RStudio session adjust automatically so you can see both your script and the results in your console when you run your syntax. It also offers the ability to call up potential syntax options while you are writing just by using the tab key.</p>

<h3 id="makes-it-convenient-to-view-and-interact-with-the-objects-stored-in-your-environment">Makes it convenient to view and interact with the objects stored in your environment</h3>

<p>RStudio has a very useful “Environment” window available which shows all of the objects that you have stored, including data; scalars, vectors, and matrices; model outputs; etc., along with a summary of the information that is stored in those objects.</p>

<h3 id="makes-it-easy-to-set-your-working-directory-and-access-files-on-your-computer">Makes it easy to set your working directory and access files on your computer</h3>

<p>With RStudio, you can navigate to folders on your computer in the “Files” window, view any files you have in that folder, and set that folder as the working directory.</p>

<h3 id="integrates-with-collaboration-and-publishing-tools">Integrates with collaboration and publishing tools</h3>

<p>Another great advantage of using RStudio for your R project is that the platform integrates with <a href="https://github.com">GitHub</a>. Once you connect RStudio with your GitHub account a remote repo becomes the “upstream” remote for your local repo. In essence, it enables you to push and pull commits to GitHub, allowing more seamless collaboration and more effective version control. RStudio also connects with <a href="https://rpubs.com/">Rpubs</a> and <a href="https://quartopub.com/">Quarto Pub</a> for easy R project web publishing.</p>

<h3 id="creates-documents-using-quarto">Creates documents using Quarto</h3>

<p>As seen, reproducibility implies sharing data, code, and workflows to produce the analysis and compute results. While writing scientific reports one may choose RStudio IDE to marry all these pieces together and take advantage of various tools it integrates with. Having a publication while minimizing reproducibility friction can be accomplished with Quarto. <a href="https://quarto.org/">Quarto</a> is a multi-language, next-generation version of R Markdown from RStudio. It includes new features and capabilities while at the same being able to render most existing Rmd files without any modification. With Quarto you can:</p>

<ul>
  <li>Create dynamic content with Rstudio/R, Python, Julia, and Observable.</li>
  <li>Author documents as plain text markdown or Jupyter notebooks.</li>
  <li>Publish high-quality articles, reports, presentations, websites, blogs, and books in HTML, PDF, MS Word, ePub, and more.</li>
  <li>Author with scientific markdown, including equations, citations, crossrefs, figure panels, callouts, advanced layout, and more.</li>
</ul>

<p>Quarto generates a .qmd file that weaves together content and executable code into a elegantly formatted output which can be published in various formats. It is a convenient tool for reproducible and dynamic reports which will help you:</p>

<ol>
  <li>Keep an eye on text (the paper) AND the source code. These computational steps are essential to ensure computational reproducibility.</li>
  <li>Conduct the entire analysis pipeline in a Quarto document: data (pre-)processing, analysis, outputs, visualization.</li>
  <li>Apply a formatting syntax that is part of the R ecosystem and supports LaTeX.</li>
  <li>Combine text written in markdown and source code written in R (and other languages).</li>
  <li>Easily share documents with colleagues, as supplemental material, or as the paper under review.</li>
  <li>Get figures automatically updated if you change the underlying parameters in the code. The error-prone task of exporting figures and uploading the right figure version to another platform is thus not needed anymore.</li>
  <li>Since it uses a text-based format, you can also use versioning control with Git.</li>
  <li>If you do not make any changes to the document after creating the output document, you can be sure that the paper was executable at least at the time of submission.</li>
  <li>Refer to the corresponding code lines in the methodology section making it unnecessary to use pseudocode, high-level textual descriptions, or just too many words to describe the computational analysis.</li>
</ol>

<blockquote class="callout">
  <h2 id="why-it-is-called-quarto">Why it is called Quarto?</h2>

  <p>Developers picked a name that had meaning in the history of publishing and landed on Quarto, which is the format of a book or pamphlet produced from full sheets printed with eight pages of text, four to a side, then folded twice to produce four leaves.</p>
</blockquote>

<blockquote class="callout">
  <h2 id="why-quarto-and-not-r-markdown">Why Quarto and not R Markdown?</h2>

  <p>As noted before, Quarto is the next generation of R Markdown which was the subject of a previous workshop <a href="https://github.com/carpentries-incubator/Reproducible-Publications-with-RStudio">see Reproducible Publications with RStudio</a>; and, the anatomy of <code class="language-plaintext highlighter-rouge">.rmd</code> and <code class="language-plaintext highlighter-rouge">.qmd</code> files are very similar. So why move to Quarto? While compatible with Python (and bash, Julia, C, SQL), R Markdown was designed primarily for R users. <strong>Quarto does not require R.</strong> Quarto runs computations into separate pluggable language “engine”, which helps make this cross language functionality easier to support and reduces infrastrucutre intensivity with built-in applications. In addition, because Quarto is designed to be compatible with existing formats you can render most existing <code class="language-plaintext highlighter-rouge">.Rmd</code> and Jupyter Notebooks with Quarto without modification. This low-pain process helps the transition to Quarto.</p>
</blockquote>

<h2 id="some-real-world-applications">Some Real-world Applications</h2>

<p>Finally, three real-world examples that motivated the authors of this lesson to value and use Quarto:</p>

<ol>
  <li>
    <p>You can publish books! <a href="https://tellingstorieswithdata.com/">Telling Stories with Data</a> is a great example developed in Quarto. Quarto books can be published to a wide variety of destinations including GitHub Pages, Netlify, RStudio Connect, or any other static hosting service or intranet web server. <a href="https://quarto.org/docs/books/">Learn more</a>.</p>
  </li>
  <li>
    <p>Imagine you want to create a short document that includes some math formulas. The LaTeX document preparation can be used for this, but it can be difficult and a overkill for just a few formulas in otherwise plain text. As we will learn, through Pandoc, Quarto lets you use just the best part of LaTeX—math formatting—while letting you write your text in a user-friendly way. The editor will automatically recognize the syntax and treat the equation as math.</p>
  </li>
  <li>
    <p>In a past version of this workshop we struggled with a scientific paper published in a reputable journal.  In trying to recreate the plots the original authors created, we found it difficult and time-consuming to figure out exactly how the authors created their plots.  Out of the many columns in their data, many with similar-sounding names, which did they use?  How did they handle missing data?  Exactly what operations did they perform to compute aggregate values?  How much easier it would have been if they had published the code they used along with their paper. RStudio and Quarto allow you to do this.</p>
  </li>
</ol>

<h2 id="a-note-about-the-workshop-example">A Note About the Workshop Example</h2>

<p>Our goal is that by the end of this workshop you will be able to create a reproducible report using data and code we will provide. Throughout this workshop, we will be using a shorter and adapted version of the data paper:</p>

<p>Nitsch, F. J., Sellitto, M., &amp; Kalenscher, T. (2021). Trier social stress test and food-choice: Behavioral, self-report &amp; hormonal data. <em>Data in brief</em>, 37, 107245. <a href="https://doi.org/10.1016/j.dib.2021.107245">https://doi.org/10.1016/j.dib.2021.107245</a>.</p>

<p>We will be also using a simplified version of the project directory containing data files and scripts published by the authors on Open Science Framework: <a href="https://doi.org/10.17605/OSF.IO/6MVQ7">https://doi.org/10.17605/OSF.IO/6MVQ7</a>.</p>

<p>The adapted paper template and project directory are used exclusively for instruction purposes with permission from the authors.</p>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Reproducible research is key for scientific advancement.</p>
</li>
    
    <li><p>RStudio can help you to organize, have better control over and produce reproducible research.</p>
</li>
    
  </ul>
</blockquote>

<hr />

<h1 id="navigating-rstudio-and-quarto-documents" class="maintitle">Navigating RStudio and Quarto Documents</h1>

<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 20 min
      <br />
      <strong>Exercises:</strong> 10 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How do you find your way around RStudio?</p>
</li>
	
	<li><p>How do you start an Quarto document in Rstudio?</p>
</li>
	
	<li><p>How is an Quarto document configured and how do I work with it?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Understand key functions in Rstudio.</p>
</li>
	
	<li><p>Learn about the structure of a Quarto file.</p>
</li>
	
	<li><p>Understand the workflow of an Quarto file.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="getting-around-rstudio">Getting Around RStudio</h2>

<p>Throughout this lesson, we’re going to teach you some of the fundamentals of
using Quarto as part of your RStudio workflow.</p>

<p>We’ll be using RStudio: a free, open source R Integrated Development Environment
(IDE). It provides a built in editor, works on all platforms
(including on servers) and provides many advantages such as integration with
version control and project management.</p>

<p>This lesson assumes you already have a basic understanding of R and RStudio but
we will do a brief tour of the IDE, review R projects and the best practices for
organizing your work, and how to install or check packages you need to follow along.</p>

<p>Now, let’s open RStudio. If you are using your local RStudio, make sure you use IDE version RStudio v2022.07.1 or later and that it is running <a href="https://quarto.org/docs/download/prerelease.html">Quarto version 1.2 or above</a>. If you need to check that, for RStudio, choose <code class="language-plaintext highlighter-rouge">Help</code> and <code class="language-plaintext highlighter-rouge">About RStudio</code>. For the Quarto version checking, type in <code class="language-plaintext highlighter-rouge">packageVersion("quarto")</code> on the console. </p>

<p><strong>Basic layout</strong></p>

<p>When you first open RStudio, you will be greeted by three panels:</p>

<ul>
  <li>The interactive R console/Terminal (entire left)</li>
  <li>Environment/History/Connections (tabbed in upper right)</li>
  <li>Files/Plots/Packages/Help/Viewer (tabbed in lower right)</li>
</ul>

<p><img src="../fig/02-rstudio.PNG" alt="RStudio layout" /></p>

<p>Once you open files, such as .qmd, .rmd or .R files, an editor panel will also
open in the top left.</p>

<p><img src="../fig/02-rstudio-script.PNG" alt="RStudio layout with .R file open" /></p>

<h3 id="r-packages">R Packages</h3>

<p>Packages are the fundamental units of reproducible R code. They include reusable R functions, the documentation that describes how to use them, and sample data. They are collections of R functions, data, and compiled code in a well-defined format. The directory where packages are stored is called the library.
It is possible to add functions to R by writing a package, or by obtaining a
package written by someone else. As of this writing, there are over 10,000
packages available on CRAN (the comprehensive R archive network). R and RStudio
have functionality for managing packages:</p>

<ul>
  <li>You can <em>install packages</em> by typing <code class="language-plaintext highlighter-rouge">install.packages("packagename")</code>, where <code class="language-plaintext highlighter-rouge">packagename</code> is the package name, in quotes.</li>
  <li>You can <em>see what packages</em> are installed by typing <code class="language-plaintext highlighter-rouge">installed.packages()</code></li>
  <li>You can <em>update installed packages</em> by typing <code class="language-plaintext highlighter-rouge">update.packages()</code></li>
  <li>You can <em>remove a package</em> with <code class="language-plaintext highlighter-rouge">remove.packages("packagename")</code></li>
  <li>You can <em>make a package available</em> for use with <code class="language-plaintext highlighter-rouge">library(packagename)</code></li>
</ul>

<p>Packages can also be viewed, loaded, and detached in the Packages tab of the
lower right panel in RStudio. Clicking on this tab will display all of installed
packages with a checkbox next to them. If the box next to a package name is
checked, the package is loaded and if it is empty, the package is not loaded.
Click an empty box to load that package and click a checked box to detach that
package.</p>

<p>Packages can be installed and updated from the Package tab with the <em>Install</em> and
<em>Update</em> buttons at the top of the tab. We have asked you to install a few packages prior to the workshop following the <a href="https://github.com/UCSBCarpentry/Reproducible-Publications-with-RStudio/blob/main/setup.md">setup instructions</a> using the <code class="language-plaintext highlighter-rouge">install.packages()</code> command. Let’s now make sure you have all of them good to go.</p>

<blockquote class="challenge">
  <h2 id="challenge-21---checking-for-installed-packages">CHALLENGE 2.1 - Checking for Installed Packages</h2>
  <p>Which command would you use to check for packages ready for use?</p>
  <blockquote class="solution">
    <h2 id="solution">SOLUTION</h2>
    <p>To see what packages are installed, use the <code class="language-plaintext highlighter-rouge">installed.packages()</code> command. This will return a matrix with a row for each package that has been installed.</p>
  </blockquote>
</blockquote>

<h2 id="starting-and-naming-a-new-quarto-document">Starting and Naming a New Quarto Document</h2>

<p>Start a new Quarto document in RStudio by clicking File &gt; New File &gt; Quarto Document…</p>

<p><img src="../fig/02-name-new-qmd.PNG" alt="Name new .qmd file" /></p>

<p>You may name your Quarto document as “My-first-qmd”.</p>

<p>New Quarto files will have a generic template unless you click the
“Create Empty Document” in the bottom left-hand corner of the dialog box.</p>

<p>We will keep all pre-selected options: HTML as the output, knitr engine and the visual editor. The output might be changed at anytime and we can easily switch between the visual and the source editor. Knitr will be the engine used to execute the R codes and to render the document in Rstudio.</p>

<p>If you see this default text you’re good to go:</p>

<p><img src="../fig/02-qmd-new-template.PNG" alt=".qmd new file generic template" /></p>

<h3 id="visual-editor-vs-source-editor">Visual Editor vs. Source Editor</h3>

<p>Remember that in the settings we chose to use the visual editor? RStudio released a new major update to their IDE in January 2020, which includes a new “visual editor” to supplement their original editor (which we will call the source editor) for authoring with markdown syntax. The visual editor follows the WYSIWYG “what you see is what you get” approach similarly to Word or Google docs that lets you choose styling options from the menu (before you had to either have the markdown code memorized or look it up for each of your styling choices). Another major benefit is that the new editor renders the styling in real time so you can preview your paper before rendering to your output format.</p>

<h4 id="source-editor">Source Editor</h4>

<p>If you toggle the source button, you will display your quarto document in the “source editor” mode. Notice the symbols scattered throughout the text (#, *, &lt;&gt;). Those are examples of markdown syntax, an easy and quick, human-readable markup language for document styling.</p>

<p><img src="../fig/02-qmd-source.PNG" alt="Add image source editor" /></p>

<blockquote class="challenge">
  <h2 id="challenge-22---formatting-with-symbols-optional">CHALLENGE 2.2 - Formatting with Symbols (optional)</h2>
  <p>Certain symbols are used to denote formatting that should happen to the text (after render it). Before that, these symbols will show up seemingly “randomly” throughout the text and don’t contribute to the narrative in a logical way. In the template qmd document, there are three types of such symbols (<code class="language-plaintext highlighter-rouge">##, **, &lt;&gt;</code>). Each symbol represents a different kind of formatting (think of your text formatting buttons you use in Word). Can you deduce from the surrounding text how these symbols format the surrounding text?</p>
  <blockquote class="solution">
    <h2 id="solution-1">SOLUTION</h2>
    <p><code class="language-plaintext highlighter-rouge">##</code> is a heading, <code class="language-plaintext highlighter-rouge">**</code> is to bold enclosed text, and <code class="language-plaintext highlighter-rouge">&lt;&gt;</code> is for hyperlinks.
Don’t worry about this too much right now! This is an example of markdown syntax for styling, you won’t need it if you stick to the visual editor, but it is recommended to get at least a basic understanding of markdown syntax if you plan to work with <code class="language-plaintext highlighter-rouge">.qmd</code> documents frequently.</p>
  </blockquote>
</blockquote>

<h4 id="visual-editor">Visual Editor</h4>

<p>Let’s switch back to the visual editor. You’ll notice that formatting elements like headings, hyperlinks and bold have been generated automatically, giving us a preview of how our text will render. The  However, the visual editor does not run any code automatically, we’ll have to do that manually (but we will learn how to do that later on).</p>

<p>We will proceed using the visual editor during this workshop as it is more
user-friendly and allows us to talk about styling without needing to teach the
whole markdown syntax system. However, we highly encourage you to become
familiar with markdown syntax as it
increases your abilities to format and style your paper without relying on the
visual editor options.</p>

<p>Note that both the visual and the source editors offer the option to display an outline of your document <img src="https://user-images.githubusercontent.com/63265343/192625580-ad6bddc1-98b7-437e-8aaf-2190651d456b.png" alt="image" /> which make it easier to navigate long documents.</p>

<blockquote class="callout">
  <h2 id="tip-resources-to-learn-more-about-quarto">Tip: Resources to learn more about Quarto</h2>
  <p>If you want to learn more about the source editor, please see
the <a href="https://quarto.org/docs/guide">Quarto Guide</a>.</p>
</blockquote>

<p>Now we’ll get into how our Quarto file &amp; workflow is organized and then on
to editing and styling!</p>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>RStudio has four panels to organize your code and environment.</p>
</li>
    
    <li><p>Manage packages in RStudio using specific functions.</p>
</li>
    
    <li><p>Quarto documents combine text and code.</p>
</li>
    
  </ul>
</blockquote>

<hr />

<h1 id="introduction-to-working-with-quarto-documents" class="maintitle">Introduction to Working with Quarto documents</h1>

<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 20 min
      <br />
      <strong>Exercises:</strong> 5 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>What is the breakdown of a Quarto document?</p>
</li>
	
	<li><p>What are templates in Quarto?</p>
</li>
	
	<li><p>How can you render the input file to the specified output format?</p>
</li>
	
	<li><p>How can you create pre-formatted for qmd document based on journal templates?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Learn about the structure of a quarto document.</p>
</li>
	
	<li><p>Learn how an quarto document works.</p>
</li>
	
	<li><p>Learn how to render a .qmd file into an output format.</p>
</li>
	
	<li><p>Understand what are jornal formats are and the advantage of using them.</p>
</li>
	
	<li><p>Learn how to start a Quarto document in RStudio.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="anatomy-of-a-quarto-document">Anatomy of a Quarto Document</h2>
<p>The key to our reproducible workflow is using Quarto files in RStudio rather than basic scripts to dynamically render both code and paper narrative. So let’s do a quick anatomy lesson on the components of an Quarto file (YAML header, Quarto formatted, R code blocks; also known as “code chunks”) and how to render them into our final formatted document.
There are four distinct steps in the Quarto workflow:</p>
<ol>
  <li>create a <strong>YAML header</strong> (optional)</li>
  <li>write Quarto-formatted <strong>text</strong></li>
  <li>add R <strong>code blocks</strong> for embedded analysis</li>
  <li>render the document with the selected engine <strong>(Knitr in this example)</strong></li>
</ol>

<p><img src="../fig/03-qmd-workflow.png" alt="Quarto Workflow" /></p>

<p>Let’s dig in to those more:</p>

<h3 id="1-yaml-header">1. YAML header:</h3>
<h4 id="what-is-yaml-anyway">What is YAML anyway?</h4>
<p>YAML, pronounced “Yeah-mul” stands for “YAML Ain’t Markup Language”. YAML is a human-readable <a href="https://en.wikipedia.org/wiki/Serialization">data-serialization</a> language which, as its name suggests, is not a markup language. YAML has no executable commands though it is compatible with all programming languages and virtually any application that deals with storing or transmiting data. YAML itself is made up of bits of many languages including Perl, MIME, C, &amp; HTML. YAML is also a superset of JSON. When used as a stand-alone file the file ending is .yml or .yaml.
<br /></p>

<p>Quarto default YAML header includes the following metadata surrounded by three dashes <code class="language-plaintext highlighter-rouge">---</code>:</p>
<ul>
  <li>title</li>
  <li>author</li>
  <li>format</li>
  <li>editor</li>
</ul>

<p><img src="../fig/03-qmd-template-yaml.png" alt="yaml highlighted in document" /></p>

<p>The format is selected in the wizard for starting a new document. You are able to pick from pdf, html, and word document. Basically, this allows you to export your qmd file as a file type of your choice. There are <a href="https://bookdown.org/yihui/rmarkdown/output-formats.html">other options for output format</a> and even more can be added by installing certain packages, but these are the three default options. <br />
<br /></p>

<p>We’ll see other formatting options for YAML later on including how to add bibliography information, customize our output, and change the default settings for executing your code. Below is an example of how our YAML file will look at the end of this workshop.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
---
title: "Data Article: Trier social stress test and food-choice: Behavioral, self-report &amp; hormonal data (Carpentry Workshop Version)"
author: "Felix Jan Nitsch; Manuela Sellitto; Tobias Kalenscher"
format: html
editor: visual
bibliography: references.bib
execute:
  echo: true
  ...
---
---
</code></pre></div></div>

<h3 id="2-formatted-text">2. Formatted text:</h3>
<p>This one is simple, it’s literally just text narrative formatted by using markdown (more on markdown syntax later). Markdown-formatted text is one of the benefits added above and beyond the capabilities of a regular r script. Any text section will have the default white background in the qmd document. As you might know, in a regular R file, # starts a comment. In Quarto, plain text is just plain narrative text that appears in the document. In R scripts, plain text wants to be code. In Quarto, you will need to enclose your code in special characters. Any symbols you do see that aren’t regular grammar components are for formatting, such as <code class="language-plaintext highlighter-rouge">##</code>, <code class="language-plaintext highlighter-rouge">** **</code>, and <code class="language-plaintext highlighter-rouge">&lt; &gt;</code>.</p>

<blockquote class="callout">
  <h2 id="tip-bonus-you-can-use-a-variety-of-languages-to-format-text-and-images-in-quarto">Tip: Bonus! You can use a variety of languages to format text and images in Quarto:</h2>
  <ul>
    <li>Quarto</li>
    <li>HTML</li>
    <li>LaTeX</li>
    <li>CSS</li>
  </ul>
</blockquote>

<h3 id="3-code-blocks">3. Code Blocks:</h3>
<p>Code blocks appear highlighted in gray throughout the qmd document. They are surrounded by three tick marks on either side (```) <strong>in source mode</strong> with the starting three tick marks followed by curly brackets <code class="language-plaintext highlighter-rouge">{}</code>with some other code inside. The tick marks indicate the start of a code section and the bits found between the curly brackets <code class="language-plaintext highlighter-rouge">{}</code>indicate how R should read and display the code (more on this in the Knitr syntax episodes). These are the sections you add R code such as summary statistics, analysis, tables and plots. If you’ve already written an R script you can copy and paste your code between the few lines of required formatting to embed &amp; run whichever piece you want at that particular spot in the document.</p>

<blockquote class="callout">
  <h2 id="tip-bonus-you-may-code-with-many-different-languages-in-rstudio">Tip: Bonus! You may code with many different languages in RStudio:</h2>
  <ul>
    <li>R</li>
    <li>Python</li>
    <li>Bash</li>
    <li>SQL</li>
  </ul>

  <p>A complete list of compatible languages can be found at: <a href="https://rmarkdown.rstudio.com/lesson-5.html">https://rmarkdown.rstudio.com/lesson-5.html</a></p>
</blockquote>

<p>Let’s take a look at the Quarto document template we have just created to see how formatted text and code are represented.</p>

<p><img src="../fig/03-qmd-template-text.png" alt="qmd template text" /><br /></p>

<blockquote class="callout">
  <h2 id="a-note-about-coding-approaches-in-rstudio">A note about coding approaches in RStudio:</h2>
  <p>When writing code in Rstudio, there are different workflows you can use, including writing code directly in the console, using a separate R script, or writing your code in a .qmd file. The best approach depends on your specific needs and preferences:</p>

  <ul>
    <li><em>Writing code directly in the console</em> is useful when you want to execute code immediately to see the effect of a statement, make a quick change or calculation. However, keeping track of your written code can be challenging, especially if it takes multiple lines. Additionally, if you need to run the same code multiple times, you’ll have to rewrite it each time, which can be inconvenient if you plan to reuse it.</li>
    <li><em>Using a separate R script</em> is a more organized way to write and save code, and you can easily reuse it later or share it with others. You can easily edit and rerun the script if you need to modify the code. However, running code in a script requires more steps than running code in the console, and it can be more challenging to modify code interactively.</li>
    <li><em>Using a .qmd file</em> combines the advantages of both the console and R script. A .qmd file allows you to write . R code and text in the same document make it easier to organize and document your work. Additionally, you can run the code directly in the paper, which makes it easier to modify and rerun code interactively.</li>
  </ul>

  <p>We will use the third approach for most of this workshop since we focus on creating a reproducible paper.</p>
</blockquote>

<h3 id="4-rendering-your-qmd-document">4. Rendering your Qmd document:</h3>
<p>Simply put, rendering is the process of converting a document into a file format or a medium that is paginated or has the concept of pages. Clicking the render button will compile the code, check for errors, and finally, output the type of file indicated in your yaml header. You may select the option “Render on Save” to see a preview of your document every time you save edits. Attention: your qmd document may not run and render as your indicated output if there are any errors in the document so it also functions somewhat as a code checker.
<br /></p>

<h4 id="try-it-yourself">Try it yourself!</h4>
<p>We’re going to pause here and see what the Quarto document does when it’s rendered. We’ll just use the generic template, but when we’re working on our own project, rendering periodically while we’re editing allows us to catch any mistakes early. We’ll continue rendering our qmd throughout the lesson to see what happens when we add our markdown and knitr syntax and to make sure we aren’t making any errors.</p>

<p>This is a little preview of what’s to come in the later episodes:
Click the “render” button.</p>

<p>Before you can render your document, you’ll need to give it a file name and choose what folder you want to save it to. Choose <code class="language-plaintext highlighter-rouge">my_first_qmd.qmd</code> as your file name and save it to an easily accessible directory in your file system.</p>

<p>Your document should render like that: <br /></p>

<p><img src="../fig/03-render-html.png" alt="Render html output" /> <br /></p>

<blockquote class="callout">
  <h2 id="warning-enable-pop-ups">Warning: Enable Pop-ups!</h2>
  <p>If using the Jupyter Hub RStudio set up, you may not see your preview until you enable pop-ups, since the webrowser of your choice may block pop-ups by default.</p>
</blockquote>

<blockquote class="challenge">
  <h2 id="challenge-31---rendering-the-document-in-another-format">CHALLENGE 3.1 - Rendering the document in another format</h2>
  <p>Suppose you want this .qmd document to render as a word document. What options would you have?</p>

  <blockquote class="solution">
    <h2 id="solution">Solution:</h2>
    <p>You may change the output format in the YAML to <code class="language-plaintext highlighter-rouge">docx</code>. 
Note that to preview word documents you need to have MS Word, Libre or Open Office installed on your machine. 
Alternatively, you may enter the following command in the terminal:
`quarto render my_first_qmd.qmd –to docx</p>
  </blockquote>
</blockquote>

<blockquote class="callout">
  <h2 id="note-about-pdfs">Note about PDFs</h2>
  <p>In order to create PDFs you will need to install a recent distribution of LaTeX. We recommend the use of TinyTeX, which you can install with the following command: <code class="language-plaintext highlighter-rouge">quarto install tool tinytex</code>.</p>
</blockquote>

<h2 id="creating-pre-formatted-papers-demonstration-only">Creating Pre-formatted Papers (Demonstration Only)</h2>

<p>We have learned how to start a new document on RStudio and we will learn good practices for project organization next. But, let’s say you are writing a paper having a journal in mind? Writing it in your own style and then formatting prior to submission will duplicate your work, right? The good news is that RStudio and Quarto can give us a hand with that.</p>

<p>Quarto offers some journal formats and made them available within the quarto-journals GitHub organization, including:</p>

<ul>
  <li>Association of Computing Machinery</li>
  <li>American Chemical Society</li>
  <li>Biophysical journal</li>
  <li>Elsevier Journals</li>
  <li>American Statistical Association Journals</li>
  <li>Journal of Statistical Software</li>
  <li>Public Library of Science</li>
</ul>

<p>This list is expected to rapidly grow with new contributions submitted to the <a href="https://github.com/quarto-journals">Quarto Journal Templates Repository</a>. You may also create your own templates following <a href="https://quarto.org/docs/journals/templates.html">these guidelines</a>.</p>

<p>Journal templates require features of Quarto version 1.2 so we need to ensure we have the right Quarto version.  You can check your Quarto version in the Terminal with command: <code class="language-plaintext highlighter-rouge">quarto --version</code>.  We should be good with that for this workshop, but if you are using a lab computer later on, you may need to update Quarto.  See: <a href="https://quarto.org/docs/download/prerelease.html">pre-release versions of Quarto</a></p>

<p>Quarto uses a template command that can be called in the terminal to create an article in any of these formats. Suppose you want to use the Elsevier template. In Rstudio, in the terminal (if not showing, select <code class="language-plaintext highlighter-rouge">Tools &gt; Terminal &gt; New</code>), type <code class="language-plaintext highlighter-rouge">quarto use template quarto-journals/elsevier</code>. Then, follow the steps below:</p>

<ul>
  <li>1) Trust the authors: <code class="language-plaintext highlighter-rouge">? Do you trust the authors of this template (Y/n) › Yes</code></li>
  <li>2) Give a name to the directory ` ? Directory name: › elsevier-template`</li>
</ul>

<p>This will install the extension and create an example qmd file and bibiography with all required files that you can use as a starting place for your article:</p>

<p><img src="../fig/03-journal-template.png" alt="Journal-Templates" /> <br /></p>

<p>Locate the directory where you have saved the template. You can make a copy of <code class="language-plaintext highlighter-rouge">elsevier-template.qmd</code> document or rename it as start writing your paper following the journal’s formatting requirements.</p>

<p>It is beyond the scope of this workshop to cover journal templates more extensively, but if you want to explore further how to apply templates, apply styling and even create your own templates, check the <a href="https://github.com/quarto-journals/article-format-template">Quarto Journals GitHub page</a>.</p>

<blockquote class="callout">
  <h2 id="tip">Tip</h2>
  <p>Before proceeding always check if the template of interest meets the most updated guidelines in the journal website, since these templates are maintained by the Quarto community, not the journal editors.</p>
</blockquote>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>An qmd file is comprised of a YAML header, formatted text in qmd and code blocks.</p>
</li>
    
    <li><p>The render function converts the file into the chosen output format.</p>
</li>
    
    <li><p>Rstudio has some journals’ formats that can save you some time or you can make your own for frequent submissions.</p>
</li>
    
  </ul>
</blockquote>

<hr />

<h1 id="good-practices-for-managing-projects-in-rstudio" class="maintitle">Good Practices for Managing Projects in RStudio</h1>

<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 30 min
      <br />
      <strong>Exercises:</strong> 10 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>What are good research project management practices?</p>
</li>
	
	<li><p>What is an R Project file?</p>
</li>
	
	<li><p>How do you start a new or open an existing R Project?</p>
</li>
	
	<li><p>How do you use version control to keep track of your work?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Best pratices for working on research projects involving data.</p>
</li>
	
	<li><p>The purpose of using .Rproj files.</p>
</li>
	
	<li><p>Using version control in RStudio.</p>
</li>
	
	<li><p>Starting or continuing an R project.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="managing-research-projects-in-r">Managing Research Projects in R</h2>
<p>Now that we’ve learned some of the basics of authoring Quarto documents, let’s take a step back and talk about research project 
management as a whole.</p>

<p>The ability to integrate code and narratives is a major advantage of the RStudio 
environment, especially considering the scientific process is naturally 
incremental, and many projects start life as random notes, some code, then a 
manuscript, and eventually everything ends up a bit mixed together. To 
complicate things further, we are often working with other collaborators, lab 
members, graduate students, faculty from the same or different institutions, 
which makes it that much more difficult to keep projects organized. When you 
throw data into the mix (sometimes huge amounts of it!), it’s integral to use 
best practices to maintain the integrity of your analysis and to be able to 
publish high quality and reproducible research. Quarto is a powerful 
tool, but it can’t be fully utilized unless your project documents, scripts and 
other files are well-organized. So let’s take a look at RStudio’s features to 
manage projects and discuss some of the best practices when working with data 
and collaborators.</p>

<h2 id="research-project-stress-points">Research Project Stress Points</h2>
<p>We often have organizational or logistical stress points in our research that 
may become breaking points, especially when it comes to working with 
collaborators, returning to a project after a hiatus, or dealing with data and 
scripts. Let’s discuss three of those common stress points:</p>

<ul>
  <li><strong>File/folder disorganization</strong>
    <ul>
      <li>You cannot find your files on your computer (or your cloud storage)</li>
      <li>Multiple versions of files with names such as “finaldraft_4.txt”</li>
      <li>Path issues when trying to run code</li>
      <li>Reviewers or colleagues cannot re-run your code/analyses</li>
    </ul>
  </li>
  <li><strong>Storage and sharing issues</strong>
    <ul>
      <li>Files are only saved to your computer and are vulnerable (or have already 
succumbed to computer/hard drive failure</li>
      <li>When working with collaborators, they (or you) don’t share the files needed</li>
      <li>Files are shared via email attachments</li>
      <li>Difficult to know if you have the latest version of documents</li>
    </ul>
  </li>
  <li><strong>Losing track of project status</strong>
    <ul>
      <li>You cannot remember where you are in a project after being away for an 
extended period (or what you worked on the previous day…no judgement)</li>
      <li>You aren’t sure what you should be working on next</li>
      <li>You have various to-do notes spread across your office or home 
(or never write them down in the first place)</li>
    </ul>
  </li>
</ul>

<blockquote class="challenge">
  <h2 id="discussion">Discussion</h2>
  <p>To what extent do these stress points affect your research projects? Are there
additional issues that you’ve encountered that slow down or derail your work 
due to issues with project management?</p>
</blockquote>

<blockquote class="challenge">
  <h2 id="discussion-antidotes">Discussion: Antidotes</h2>
  <p>What are some practices you implement to keep your project materials organized?</p>
</blockquote>

<h3 id="antidotes">Antidotes</h3>

<p>A good project layout will ultimately make your life easier:</p>
<ul>
  <li>It will help ensure the integrity of your data</li>
  <li>It makes it simpler to share your code with someone else (a lab-mate, 
collaborator, advisor, etc.)</li>
  <li>It allows you to easily upload your code with your manuscript submission</li>
  <li>It makes it easier to pick the project back up after a break.</li>
  <li>It makes your research reproducible!</li>
</ul>

<p>We’ll discuss three aspects of project management and then implement those 
practices for the remainder of this workshop in the RStudio environment.</p>

<ol>
  <li>File/Folder Organization</li>
  <li>Storage &amp; Sharing</li>
  <li>Using Version Control</li>
</ol>

<p>Then, we’ll get started on our project!</p>

<h2 id="project-filefolder-organization">Project File/Folder Organization</h2>
<h3 id="important-principles">Important principles:</h3>

<p>Although there is no “best” way to lay out a project, there are some general 
principles to adhere to that will make project management easier:</p>

<h4 id="practice-good-file-organization"><strong>Practice good file-organization</strong></h4>

<p><a href="http://swcarpentry.github.io/good-enough-practices-in-scientific-computing/">Good Enough Practices for Scientific Computing</a> gives the following recommendations for project organization:</p>
<ol>
  <li>Put each project in its own directory, which is named after the project.</li>
  <li>Put text documents associated with the project in the doc directory.</li>
  <li>Put raw data and metadata in the data directory, and files generated during cleanup and analysis in a results directory.</li>
  <li>Put source for the project’s scripts and programs in the src directory, and programs brought in from elsewhere or compiled locally in the bin directory.</li>
  <li>Name all files to reflect their content or function.</li>
  <li>Additionally, we’d recommend to include README, LICENSE, and CITATION files!</li>
</ol>

<p>For our project we’re working in today, we used the following setup for folders and files:</p>

<p><img src="../fig/04-directory-tree.png" alt="directory tree" /></p>

<blockquote class="challenge">
  <h2 id="challenge-41-take-a-few-minutes-to-look-through-the-workshop-project-files">Challenge 4.1: Take a few minutes to look through the workshop project files</h2>

  <p>Please take some time to look through the project files. Either the screenshot above, or you may browse the files on GitHub at <a href="https://github.com/MonashDataFluency/r-rep-res-quarto-example">https://github.com/MonashDataFluency/r-rep-res-quarto-example</a>. What do each of the directories (folders) contain? What is their purpose?</p>

  <p>See the solution drop-down for an explanation of each directory’s contents.</p>

  <blockquote class="solution">
    <h2 id="solution">Solution:</h2>

    <ul>
      <li><strong>code:</strong> contains the scripts that generate the plots and analysis (found in <code class="language-plaintext highlighter-rouge">output/plots</code>)
        <ul>
          <li><strong>/functions:</strong> contains custom functions written for the data pre-processing</li>
        </ul>
      </li>
      <li><strong>data:</strong> this folder contains the raw and cleaned data files
        <ul>
          <li><strong>/foodchoice_data:</strong> contains the individual data files from food choice trials</li>
        </ul>
      </li>
      <li><strong>output:</strong> contains processed/transformed data and all plots generated
        <ul>
          <li><strong>/data:</strong> contains the output data file after applying custom pre-processing function</li>
          <li><strong>/plots:</strong> contains pdfs of the plots generated from the plot scripts in the code folder</li>
        </ul>
      </li>
      <li><strong>report:</strong> all files needed for the publication of the research project, including:<br />
              - .qmd file for the paper and additional files needed for rendering the paper<br />
            - images created specifically (not through the analysis scripts) for the paper
        <ul>
          <li><strong>/output:</strong> contains the final output of the Quarto paper</li>
        </ul>
      </li>
      <li><strong>R-repro-pub.Rproj:</strong> the R project file that lives in the root directory.</li>
      <li><strong>README.md:</strong> a detailed project description with all collaborators listed.</li>
      <li><strong>CITATION.md:</strong> directions to cite the project.</li>
      <li><strong>LICENSE.md:</strong> instructions on how the project or any components can be reused.</li>
    </ul>

  </blockquote>
</blockquote>

<h4 id="practice-good-file-naming"><strong>Practice good file-naming</strong></h4>

<p>The three principles of file-naming are:</p>

<ol>
  <li>Machine-readable
    <ul>
      <li>Friendly for searching (using regular expressions/globbing)</li>
    </ul>
    <ul>
      <li>No spaces, unsupported punctuation, accented characters, or case-sensitive file names<br />
    - Friendly for computing<br />
      - Deliberate use of delimiters (i.e. for splitting file names)</li>
      <li><code class="language-plaintext highlighter-rouge">data-analyses-fig1.R</code> with <code class="language-plaintext highlighter-rouge">-</code> used consistently as a separator</li>
    </ul>
  </li>
  <li>Human-readable
    <ul>
      <li>Name contains brief description of content</li>
      <li>Borrow from clean URL practices:
        <ul>
          <li>“slug” i.e. the part of a url that is human readable</li>
        </ul>
      </li>
    </ul>
    <ul>
      <li>i.e. <code class="language-plaintext highlighter-rouge">data-analyses-fig1.R</code></li>
    </ul>
  </li>
  <li>Plays nice with default ordering
    <ul>
      <li>Use chronological or logical order:</li>
    </ul>
    <ul>
      <li><strong>chronological</strong>: filename starts with date.
        <ul>
          <li>i.e. <code class="language-plaintext highlighter-rouge">2022-01-01_data_analyses.R</code></li>
          <li>Use <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601 date standard</a></li>
        </ul>
      </li>
      <li><strong>logical</strong>: filename starts with a number or keyword/number combo.
        <ul>
          <li>i.e. <code class="language-plaintext highlighter-rouge">01_data_preprocessing.R</code> <em>see code directory</em></li>
          <li>i.e. <code class="language-plaintext highlighter-rouge">CC-101_1_data.csv</code> <em>see data directory</em></li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<p>Adapted from <a href="https://datacarpentry.org/rr-organization1/01-file-naming/index.html">https://datacarpentry.org/rr-organization1/01-file-naming/index.html</a>. For more tips on file naming, check: <a href="https://www.library.ucsb.edu/sites/default/files/dls-n01-2021-filenaming.pdf">The Dos and Don’ts of File Naming</a>.</p>

<blockquote class="challenge">
  <h2 id="challenge-42-file-name-syntax">Challenge 4.2: File name syntax</h2>

  <p>Given the filename <code class="language-plaintext highlighter-rouge">CC-101_1_data.csv</code> and <code class="language-plaintext highlighter-rouge">2022-01-01_data_analyses.R</code>, why does it make sense to use both <code class="language-plaintext highlighter-rouge">-</code> and <code class="language-plaintext highlighter-rouge">_</code> as delimiters/separators?</p>

  <blockquote class="solution">
    <h2 id="solution-1">Solution:</h2>
    <p>In <code class="language-plaintext highlighter-rouge">CC-101_1_data.csv</code>, the <code class="language-plaintext highlighter-rouge">-</code> is used as part of the keyword that is shared between a number of files. the <code class="language-plaintext highlighter-rouge">_</code> separates it from the trial number and description. If one were to split the filename on the <code class="language-plaintext highlighter-rouge">_</code>, the keyword would be maintained and the trial number would be separated out. 
In the <code class="language-plaintext highlighter-rouge">2022-01-01_data_analyses.R</code>, <code class="language-plaintext highlighter-rouge">-</code> is used for a delimiter for the date, between year month and day. <code class="language-plaintext highlighter-rouge">_</code> is used between the rest. This allows us to split on <code class="language-plaintext highlighter-rouge">_</code> which would preserve the date (separate from other file info).</p>

    <p>It’s good to strategize on the best way to name files to anticipate future uses of the information contained within the filename.</p>
  </blockquote>
</blockquote>

<h4 id="use-relative-paths"><strong>Use relative paths</strong></h4>

<p>A path specifies a series of steps to a file. It consists of a series of directory names, and finally a filename, separated by <code class="language-plaintext highlighter-rouge">/</code>. Windows traditionally uses <code class="language-plaintext highlighter-rouge">\</code> as the separator, but in R we can always use <code class="language-plaintext highlighter-rouge">/</code>.</p>

<p>Absolute paths start with <code class="language-plaintext highlighter-rouge">/</code> on Mac or Linux, denoting the “root” directory. On Windows, absolute paths start with a drive letter such as <code class="language-plaintext highlighter-rouge">C:</code>. We will try to avoid using absolute paths.</p>

<p>Whenever R is running, it has a current working directory, which you can check with <code class="language-plaintext highlighter-rouge">getwd()</code>. Relative paths don’t start with <code class="language-plaintext highlighter-rouge">/</code> or <code class="language-plaintext highlighter-rouge">C:</code>, and refer to directories and files relative to the current working directoy.</p>

<p>For example we might read a file using a relative path like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>df &lt;- read.csv("data/foodchoice_budgetlines.csv")
</code></pre></div></div>

<p>whereas an absolute path might look like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Windows
df &lt;- read.csv("C:/Users/wilma/Desktop/project23/data/foodchoice_budgetlines.csv")

# Mac
df &lt;- read.csv("/Users/wilma/Desktop/project23/data/foodchoice_budgetlines.csv")
</code></pre></div></div>

<p>You can also use the special direcory name <code class="language-plaintext highlighter-rouge">..</code> to refer to the parent directory, eg <code class="language-plaintext highlighter-rouge">../project22/data/foo.csv</code>.</p>

<p><strong>We will try to always run code with our project directory as the current working directory.</strong></p>

<p>Quarto documents by default set the working directory to the directory containing the document. In a later section we will discuss how to disable this annoying behaviour! (An older solution to this problem involved use of a package called <code class="language-plaintext highlighter-rouge">here</code> to find files relative to the project directory.)</p>

<!--
This goes hand-in-hand with keeping your project within one “root” directory. If you use complete paths to say, read in your data to RStudio and then share your code with a collaborator, they won’t be able to run it because the complete path you used is unique to your system and they will receive an error that the file is not found. That is why one should always use relative paths to link to other files in the project, i.e. “where is my data file in relation to the script I’m reading the data into?”. The practice of using relative paths is made easier by having a logical directory set up and keeping all project files within one root project folder. 

Assuming your R script is in a `code` directory and your data file is in a `data` directory then an example of a relative path to read your data would be:

```
df <- read.csv("../data/foodchoice_budgetlines.csv", encoding = "UTF-8")
```

Whereas a complete path might look like:

Windows: 

```
df <- read.csv("C:/Users/wilma/Desktop/project23/data/foodchoice_budgetlines.csv", encoding = "UTF-8")
```

If the example was on a Mac or Linux computer you would have `home` instead of `C:`   


In the complete path example you can see that the code is not going to be portable. If someone other than Wilma Flintstone wanted to run the r script they would have to alter the path to match their system.

> ## Challenge 4.3: relative paths
> 
> What would be the relative path needed to refer to the `bronars.pdf` plot (located in the plots directory) from `R-repro-pub.Rproj` (located in the root directory). What is the inversed relative path?
>
> > ## Solution:
> >
> > `R-repro-pub.Rproj` to `bronars.pdf`
> > "output/plot/bronars.pdf"
> >
> > `bronars.pdf`to `R-repro-pub.Rproj`
> > "../.."
> > ".." directs back to the directory that contains the directory of the file of interest.
> >
> {: .solution}
{: .challenge}

> ## Tip: Level up your relative paths
> We just discussed how relative paths are a better practice when coding because we can guarantee our code will work on somebody else's system. However, relative paths can still be quite confusing to deal with, especially when you have many sub-directories in your project. One way to make things a bit easier on ourselves is to make sure the part that's *relative* to what we're referencing is always the same. 
> We can employ a package called "here" to do this. `Here` has a function which always references the root (or top-level) directory of your project (i.e. where the .rproj file lives). Conviniently, that function is called `here()`. `here()` gives us a consistent starting path when building relative paths. We'll see how this is used later in the lesson.

- Read the CRAN documentation here: [here](https://cran.r-project.org/web/packages/here/vignettes/here.html)
- [Read more about how the `here` package can be useful for R Markdown and Quarto files specifically](http://jenrichmond.rbind.io/post/how-to-use-the-here-package/)
{: .callout}
-->

<h4 id="treat-data-as-read-only"><strong>Treat data as read only</strong></h4>
<p>This is probably the most important goal of setting up a project. Data is typically time consuming and/or expensive to collect. Working with them interactively (e.g., in Excel or R) where they can be modified means you are never sure of where the data came from, or how it has been modified since collection. It is therefore a good idea to treat your data as “read-only”. However, in many cases your data will be “dirty”: it will need significant preprocessing to get into a format R (or any other programming language) will find useful. Storing these scripts in a separate folder, and creating a second “read-only” data folder to hold the “cleaned” data sets can prevent confusion between the two sets. You should have separate folders for each: raw data, code, and output data/analyses. You wouldn’t mix your clean laundry with your dirty laundry, right?</p>

<h4 id="treat-generated-output-as-disposable"><strong>Treat generated output as disposable</strong></h4>
<p>Anything generated by your scripts should be treated as disposable: it should all be able to be regenerated from your scripts.
There are lots of different ways to manage this output. Having an output folder with different sub-directories for each separate analysis makes it easier later. Since many analyses are exploratory and don’t end up being used in the final project, and some of the analyses get shared between projects.</p>

<h4 id="include-a-readme-file"><strong>Include a README file</strong></h4>

<p>For more information about the README file and a customizable template, check this <a href="https://www.library.ucsb.edu/sites/default/files/dls-n03-2021-readme-navy.pdf">handout</a>. Make sure to include citation and license information both for your data <a href="[https://creativecommons.org/licenses/">see creative commons license</a> and software (<a href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/licensing-a-repository">see license types on Github</a>). This information will be critical for others to reuse and correctly attribute your work. You may also consider adding a separate citation and license file to your project folder.</p>

<p>Again, there are no hard and fast rules here, but remember, it is important at least to keep your raw data files separate and to make sure they don’t get overridden after you use a script to clean your data. It’s also very helpful to keep the different files generated by your analysis organized in a folder.</p>

<p>*what’s this .Rproj file? We’ll explain in a bit.</p>

<h2 id="storage-and-sharing">Storage and Sharing</h2>

<h3 id="backup-your-work">Backup your work</h3>

<p>Having a solid backup plan in case of emergencies (say your hard drive on your computer fails) is essential. The general guideline for back ups is to adhere to the <a href="https://www.uschamber.com/co/run/technology/3-2-1-backup-rule">3-2-1 principal</a> which dictates that you should have 3 copies, on 2 different media, with 1 copy offsite. Your decision on backups will be based on your own personal tolerance but we recommend at minimum to avoid only having a copy of your project on your personal, work computer or a lab computer at all costs.</p>

<p>At the very least, you should backup your project into cloud storage (either provided by your university or paid for yourself). Common cloud storage platforms include Google drive, Box, OneDrive, Dropbox, etc. Backing up a project on a local device to cloud storage allows you to meet two of the 3-2-1 criteria (2 different media and 1 offsite). If you’re working with at least one collaborator and they also keep an up-to-date copy of the project on their computer, you’re set!</p>

<h3 id="version-control-hosting-services">Version Control hosting services</h3>

<p>If your research project involves code, the best way to make sure you have your work backed up AND keep track of your code and data is to use a version control hosting service such as GitHub - though we’d recommend using version control for any large projects.</p>

<p>The main three version control hosting services are GitHub, GitLab, and BitBucket, to see a comparison of the available options, see this comparison on <a href="https://www.linkedin.com/pulse/demystifying-git-vs-github-atlassian-bitbucket-gitlab-pawan-verma?trk=read_related_article-card_title.">LinkedIn</a></p>

<p>We will proceed using GitHub because it is the most used version control platform to date.</p>

<h2 id="using-version-control">Using Version Control</h2>

<p>Ok, now let’s talk about implementing version control in your project through RStudio! But first… let’s quickly clarify the difference between Git and GitHub. We already said that GitHub is the version control hosting platform. Git is the version control system and does not <strong>have</strong> to be used with GitHub. You can use Git and then host your code on Bitbucket for example, or save to your Google drive. In fact, you can use Git on your local system only and never save it to a cloud storage platform. However, version control hosting platforms such as GitHub enhance the benefits of version control and offer incredible collaboration features. The difference between the two can be a bit confusing because they are so often used together, but the more you use them the more it will make sense. Soon enough you’ll be wondering how you even completed a code project without version control.</p>

<p>There are actually many ways to use Git, you could use it on GitHub only (though that suffers from lack of options and is a bit clunky), there is a Desktop interface, many serious programmers use it on command line. HOWEVER, RStudio has Git controls built in so we’ll use it there - all in one place!</p>

<h3 id="project-environments-in-r">Project Environments in R</h3>

<p>Environments are a rather advanced topic in programming, but we will introduce some capabilities for projects in R that increase the reproducibility of your code. Essentially, a project environment allows us to save (or take a snapshot) of our R version and dependencies - aka what packages/package versions are required to run our code without error. This can be important when you are collaborating with others and may be unsure of whether you are working with the same R and package versions. Another common issue is if you try to run very old code from a previous project - the older the code, the more likely that errors will crop up or that the code will no longer run as it used to. To take advantage of project environments we will use a package called <code class="language-plaintext highlighter-rouge">renv</code> which is the successor of <code class="language-plaintext highlighter-rouge">packrat</code> which used to be the de facto package in R for managing environments.</p>

<p>However, as noted in this <a href="https://rstudio.github.io/renv/articles/renv.html">RStudio article on renv</a>, using <code class="language-plaintext highlighter-rouge">renv</code> does not automatically make your project reproducibile, nor is it bullet-proof. Sometimes other factors come into play that may alter the results of your code despite using <code class="language-plaintext highlighter-rouge">renv</code>, such as operating systems,  compilers etc. To go one step further in assuring reproducibility, many use ‘containers’ such as Docker or Kubernetes. However, that is beyond the scope of this workshop.</p>

<p>We will see in episode 8 how one can implement project environments with <code class="language-plaintext highlighter-rouge">renv</code> to increase reproducibility with R projects.</p>

<p>Before we use Git and environments in RStudio project, we must be working in an R Project so let’s talk about how R Projects work in RStudio.</p>

<h3 id="working-in-r--quarto-projects">Working in R &amp; Quarto Projects</h3>

<h4 id="r-project">R Project</h4>

<p>One of the most powerful and useful aspects of RStudio is its project management functionality. We’ll be using an R project today to complement our Quarto document and bundle all the files needed for our paper into one self-contained, reproducible bundle. An <code class="language-plaintext highlighter-rouge">.Rproj</code> file helps keep your R scripts, data and other files together - just navigate through your file system to get to your project directory and double click on the .Rproj file. The added benefit is that the .RProj file will automatically open RStudio and start your R session in the same directory as the <code class="language-plaintext highlighter-rouge">.Rproj</code> file and remember exactly where you left off. .RProj files are powerful ways to stay organized on their own, but they also unlock the additional benefit of being able to use Git within RStudio.</p>

<h4 id="quarto-projects">Quarto Projects</h4>

<p>Perhaps, confusing but we have an additional “type” of project in the RStudio ecosystem called a Quarto project. Thankfully, we don’t necessarily have to pick between using R and Quarto projects because a Quarto project is just an R project - with some additional capabilities. That addition is enhanced project and style controls in the form of a YAML file called <code class="language-plaintext highlighter-rouge">_quarto.yml</code> . To keep things simple, if you are going to use Quarto documents, use Quarto Projects, if you aren’t, stick to an R project. And no worries, you can always add a <code class="language-plaintext highlighter-rouge">_quarto.yml</code> file if you have just an R Project which can retroactively turn your project into a Quarto project. Let’s see how to create a Quarto project in the next episode.</p>

<blockquote class="challenge">
  <h2 id="challenge-44-r-project-in-root-folder">Challenge 4.4: R Project in “root” folder</h2>
  <p><code class="language-plaintext highlighter-rouge">.Rproj</code> files must be in the root directory of your project folder/directory. What is the root directory again (look back at the relative paths intro)?</p>
</blockquote>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Use best practices for file and folder organization. This includes using relative file paths as opposed to complete file paths.</p>
</li>
    
    <li><p>Make sure that all data are backed up on multiple devices and that you treat raw data as read-only.</p>
</li>
    
    <li><p>We can use Git and Github to keep track of what we’ve done in the past, and what we plan to do in the future.</p>
</li>
    
    <li><p>Rproj files are pivotal to keeping everything bundled and organized.</p>
</li>
    
  </ul>
</blockquote>

<hr />

<h1 id="getting-your-project-set-up-with-version-control-in-rstudio" class="maintitle">Getting Your project set up with Version Control in RStudio</h1>

<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 30 min
      <br />
      <strong>Exercises:</strong> 10 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How do I start or continue a project with Git versioning?</p>
</li>
	
	<li><p>What are the features in the RStudio Interface for working with Git?</p>
</li>
	
	<li><p>What are the basics of the Git versioning workflow?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Copy an existing project on Github to make contributions</p>
</li>
	
	<li><p>Open a project with Git versioning in RStudio</p>
</li>
	
	<li><p>Learn the basics of Git - pull, add, commit, push</p>
</li>
	
	<li><p>Make our first edits in a verison controlled project</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="using-r-projects-and-version-control-in-rstudio">Using R projects and Version Control in RStudio</h2>

<p>Using version control is a powerful feature to make your research more reproducible and better organized. In order to use versioning while working in RStudio the first step is to make sure your work is set up as an R Project, because you may not use the versioning features in RStudio without one. There are three options for doing this depending on your given scenario.</p>

<h2 id="three-methods-of-setting-up-versioning-with-an-r-project">Three Methods of Setting up Versioning with an R Project</h2>

<p>There are several options for working with R projects in RStudio. If you aren’t already working in an R Project, you can create a new one. There are three options here:</p>
<ol>
  <li><strong>New Directory</strong> - start a brand new R project (with the option of version control).</li>
  <li><strong>Existing Directory</strong> - add existing work to a R project (with the option of setting up version control).</li>
  <li><strong>Version Control</strong> Continue an existing R project that already uses version control (i.e. download from GitHub).</li>
</ol>

<p><img src="../fig/05-new-project.PNG" alt="new r project options" /></p>

<p>The third option would be a project already under version control but options 1 and 2 will also give you the opportunity to use or add versioning to the project. Let’s see how that would work.</p>

<hr />

<h3 id="starting-a-r-project-with-version-control">Starting a R Project with Version Control</h3>
<h4 id="method-1">Method #1</h4>

<p>To start an R project, you would navigate to <code class="language-plaintext highlighter-rouge">File &gt; new project</code> rather than just <code class="language-plaintext highlighter-rouge">File &gt; new file</code>.</p>

<p><img src="../fig/05-new-directory.png" alt="New directory" /></p>

<p>After choosing <code class="language-plaintext highlighter-rouge">New Directory</code> chose <code class="language-plaintext highlighter-rouge">new project</code> on the next menu options.</p>

<p>Then, to use version control, make sure to check the “<em>Create a git repository</em>” box as highlighted in this screen shot:
<img src="../fig/05-brand-new-project.PNG" alt="new project w/ version control" /></p>

<p>*Note when you choose directory name, it will create a new directory in the directory you specified along with an .Rproj file of the same name. Avoid spaces here. underscores “_”, dashes “-“ or camel case “NewProject” is the recommended way to name this directory/file.</p>

<p>*Optionally, check the box in the bottom left corner “Open in new session” if you want it to appear in a new RStudio window.</p>

<hr />

<h3 id="add-versioning-to-an-existing-project">Add versioning to an existing project</h3>
<h4 id="method-2">Method #2</h4>

<p><img src="../fig/05-existing-directory.png" alt="existing project" /></p>

<p>We won’t take the time to cover this here, but if you’ve already started a Quarto project WITHOUT version control, you have the option to add version control retrospectively. You can also add existing R files to a project and setup version control if you’ve done neither. To see a tutorial of this process,  please see <a href="https://swcarpentry.github.io/git-novice/14-supplemental-rstudio/index.html">episode 14 “Using Git from RStudio” in Version Control with Git</a>.</p>

<p>This is by far the most labor intensive way to do it, so remember to add version control at the beginning of any new project.</p>

<hr />

<h3 id="continue-a-version-controlled-project">Continue a version-controlled project</h3>
<h4 id="method-3">Method #3</h4>

<p><img src="../fig/05-version-control.png" alt="version controlled" />
The final option is to continue a version controlled project. This is the option we will do for our workshop.</p>

<p>First, indicate which version control language you will be using (Subversion is another version control system, though less popular than Git)</p>

<p><img src="../fig/05-new-project-git.PNG" alt="Git or Subversion" /></p>

<p>When you choose this option there will be a place to paste the url of the GitHub (or other hosting platform) url. The name of the repository will automatically populate. Just choose which directory on your computer you wish to save the project directory and your good to go!</p>

<p><img src="../fig/05-new-project-git-url.PNG" alt="continue project from GitHub" /></p>

<blockquote class="prereq">
  <h2 id="our-turn">Our turn!</h2>

  <p class="source">We have a repository already prepared for this workshop at <a href="https://github.com/MonashDataFluency/r-rep-res-quarto-example">https://github.com/MonashDataFluency/r-rep-res-quarto-example</a>. 
We are going to use the third option to download this repository from GitHub and work with it hands on. You will need this repo in your working environment if you would like to follow along through this workshop.
Let’s take a second to acquaint ourselves with GitHub. <a href="https://github.com/signup">At this link</a>, you may sign into your GitHub account or create one if you have not already.</p>
</blockquote>

<p><img src="../fig/05-github.PNG" alt="GitHub" /></p>

<p>The two main sections are files and directories and the README which should contain a narrative description of the project.</p>

<p>We are each going to make a copy of this repository to use for this workshop. To do so we will do what’s called “forking” on GitHub. A Fork is a copy of a repository that you get to experiment with without disrupting the original project.</p>

<p>On Github in the upper right hand corner of the repository, click on the button that says “Fork” - see highlighted example below:</p>

<p><img src="../fig/05-fork.PNG" alt="fork on GitHub" /></p>

<p>If you are a member of any organizations on GitHub, you will be asked whether you want to fork to your account or to an organization. Choose your personal account for this workshop.  GitHub will process for a few moments and voila! You have your own copy of the workshop example repository.</p>

<p>Now, click on the green <code class="language-plaintext highlighter-rouge">Code</code> drop-down and then click on the copy icon next to the repository url:</p>

<p><img src="../fig/05-copy-repo.PNG" alt="copy GitHub repository url" /></p>

<p>Now, let’s return to RStudio:</p>

<p>Click <code class="language-plaintext highlighter-rouge">File &gt; New Project &gt; Version Control &gt; Git</code>.</p>

<p>So back to the url you copied from GitHub. Navigate again to <code class="language-plaintext highlighter-rouge">File &gt; New Project &gt; Version Control &gt; Git</code>. Paste in your url and click the “Create Project” button.</p>

<p><img src="../fig/05-git-new-project-clone.png" alt="start my R project" /></p>

<p>Now you have cloned a copy of your git repo from Github to your working environment.</p>

<p>If you’re working in the JupyterHub environment you will need to configure Git with your name and email before you’ll be able to commit the changes you make during this workshop.  Substitute your name and email address in the commands below and paste them into the Terminal panel of RStudio.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git config --global user.email "you@example.com"
git config --global user.name "Your Name"
</code></pre></div></div>

<p>Woo hoo! We have the project we’re working on for this workshop opened in RStudio and set to use version control!</p>

<blockquote class="callout">
  <h2 id="git-not-detected-on-system-path">Git not detected on system path</h2>

  <p>If you are using Git for the first time in RStudio at this point you may be getting a notification that Git isn’t set up to work with RStudio.</p>

  <p>See the solution below:</p>
  <blockquote class="solution">
    <h2 id="solution">Solution:</h2>
    <p><img src="../fig/05-git-not-detected.png" alt="Git not detected on system path" /></p>

    <p>To set it up we need to go to Tools &gt; Global Options
<img src="../fig/05-setup-git-rstudio.PNG" alt="Global Options Git/SVN setup" /></p>

    <p>First, make sure “Enable version control interface for RStudio projects” is checked. Next, you must make sure that the Git executable path is correct.
For macs, more than likely the path will have automatically populated. In all likelihood that path is <code class="language-plaintext highlighter-rouge">/usr/bin/git</code>. Windows users may find that the correct path is also pre-populated, but it is likely that you may need to manually add it by clicking “browse”. More than likely your path will be something like <code class="language-plaintext highlighter-rouge">C:/Program Files/Git/bin/git.exe</code>. If not, search for where Git for Windows was installed (Git) go into the bin folder and select the ‘git.exe` file.</p>

    <p>Ok! Now that we set that up (by the way, this is a one time set up -it will work now for all future projects in RStudio on your device), we should be able to open our project from GitHub in RStudio.</p>
  </blockquote>
</blockquote>

<p>Now, let’s dive in to how to use version control.</p>

<h2 id="using-version-control-in-rstudio">Using Version Control in RStudio</h2>

<p>There are two places we can interact with Git in the RStudio interface.</p>
<ol>
  <li>Menu bar <img src="../fig/05-git-top-menu.PNG" alt="Git menu bar" /> <br /></li>
  <li>Environment/History pane <img src="../fig/05-git-environment-window.PNG" alt="git environment panel" /></li>
</ol>

<p>Ok, but what do all the options mean? We won’t go through them all, but here are the basics to get started versioning your project.</p>

<h3 id="git-workflow">Git Workflow</h3>

<p>The most simple workflow for version control (working on your computer only)
is referred to as “add” and “commit”:</p>

<p>But what do those words even mean?</p>

<p><strong>add:</strong> choose a file or files to take a “snapshot” of. Aka what files do you want to add to your next version?</p>

<p><strong>Commit:</strong> Taking a “snapshot” of a selected version of your project. The snapshot will <em>only</em> include the files you “added”, typically only files that you’ve edited since your last commit.</p>

<p>You may have a few to many commits in a single work session.</p>

<p>When you commit, you add a “commit message” aka a short line of text (recommended 50 characters or less) that describes the changes that were made to the file(s) you added. This helps keep your versions organized and makes it easier to go back to remember what you did or to restore your work to exactly the version needed if you make a mistake or want to implement a change.</p>

<p><img src="../fig/05-git-add-commit.svg" alt="git add commit workflow" /></p>

<h4 id="git-workflow-with-github">Git Workflow with GitHub</h4>

<p>If we are saving our work to a version control hosting cloud platform such as GitHub,
our workflow gets a bit more complex, we add a “pull” and “push” step at the beginning and end of a work session.</p>

<p><code class="language-plaintext highlighter-rouge">Pull &gt; add &gt; commit &gt; push</code></p>

<p><strong>Pull:</strong> <em>download</em> the most recent version of the repository <em>from</em> GitHub <em>to</em> your local computer.</p>

<p><strong>Push:</strong> <em>upload</em> the most recent version of the repository <em>to</em> GitHub <em>from</em> your local computer.</p>

<p>Put a pin in pulling and pushing for now. For the time being as we edit our paper we will just stick to adding and commiting. At the end we’ll see how to use push to GitHub, and you can experiment with pulling later on.</p>

<h3 id="tips-for-working-with-git">Tips for working with Git</h3>

<ul>
  <li>You should pull each time you start working on your project after a hiatus, or before each edit if you know a team member is working at the same time.</li>
  <li>Commit frequently, each commit should be a distinct set of edits which you can summarize in 50 characters or less. Don’t add a bunch of unrelated edits to the same commit, it makes it harder to look back through your “snapshots” and find the right one if you need to.</li>
  <li>At the end of your work session (or more frequently if you are working at the same time as team members), “push” your commits to the remote repository - this is the only way your local changes get added to your team’s remote repository.</li>
</ul>

<p>This pull, add, commit, push routine will become second nature. Pulling at the beginning and pushing at the end of your work session becomes a sort of ritual that marks the beginning and end of your work session.</p>

<h2 id="your-first-edit">Your first edit</h2>

<p>Now, let’s open up the report in this repository that’s already been drafted. You will find it in the <code class="language-plaintext highlighter-rouge">report</code> directory with filename: <code class="language-plaintext highlighter-rouge">DataPaper-ReproducibilityWorkshop.qmd</code>.  Open it up and we will make an edit to the yaml front matter of this draft report so we can practice using version control.</p>

<p>In the title add “(Carpentry Workshop Version)” and make sure to save it.</p>

<p><img src="../fig/05-editing.png" alt="git panel add" /></p>

<p>Now, in the Environment panel, toggle to the Git tab. You’ll see the file that was edited with a check mark next to it. Click the check mark to “add” . Note that if you edited more than one file you could choose any or all of the documents to “add”.</p>

<p><img src="../fig/05-first-edit.PNG" alt="git panel add" /></p>

<p>Now, click commit. A dialogue box will pop up. You’ll need to add a commit message to proceed. Add something about editing the title. The difference between your files will show in the bottom panel.</p>

<p><img src="../fig/05-rstudio-commit.png" alt="commit in RStudio" /></p>

<p>Hit commit and a dialogue box will show a completed commit. Warning: <strong>DO NOT PUSH</strong> anything yet!</p>

<p>You made your first commit!</p>

<blockquote class="challenge">
  <h2 id="discussion-optional-utilizing-gitignore-files">Discussion: (optional) Utilizing .gitignore files</h2>
  <p>a <code class="language-plaintext highlighter-rouge">.gitignore</code> file is used to signal to Git to NOT track versions of specific files. One instance where this is used in a data analysis project is with data files that are too large to be uploaded to GitHub.</p>

  <p>Now, there are some caveats to this, so in what situations would it make sense to add data to the .gitignore and what situations would it not? What else could you imagine you wouldn’t want to track in your research project?</p>

  <blockquote class="solution">
    <h2 id="solution-1">Solution:</h2>
    <p>Why and when would it be a good idea to add data files to the <code class="language-plaintext highlighter-rouge">.gitignore</code>?</p>
    <ul>
      <li>With raw data files - since they will not be modified (remember: raw data = read only).</li>
      <li>With sensitive data - This should absolutely not be pushed to GitHub</li>
    </ul>

    <p>Why and when would it not make sense to add data files to the <code class="language-plaintext highlighter-rouge">.gitignore</code> so they will be available in the Git repository.</p>
    <ul>
      <li>pre-processed data files - these are the data files that are edited - processed from the raw data</li>
      <li>small data files - may not make much of a difference whether they are tracked or not</li>
      <li>the first time you add data files - You can’t push data files to GitHub unless they are tracked. So if you want your data on GitHub, but don’t want to track it, you must make sure you push once and then add the file to the .gitignore file.</li>
    </ul>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="challenge-optional-add-the-data-filesdirectories-to-gitignore">Challenge: (optional) Add the data files/directories to .gitignore</h2>
  <p>Add the data (all of the raw data files) to the <code class="language-plaintext highlighter-rouge">.gitignore</code>.<br />
Hint: there are two ways to do this.<br />
Hint2: add a forward slash <code class="language-plaintext highlighter-rouge">/</code> after directories.</p>

  <blockquote class="solution">
    <h2 id="solution-2">Solution:</h2>
    <p>1) open the .gitignore file by double-clicking on it in the file view pane, on a new line add <code class="language-plaintext highlighter-rouge">data/</code>. Save the file and don’t forget to commit it.
<img src="../fig/05-gitignore-file.PNG" alt=".gitignore file" />
2) Click on the settings gear in the Git tab of the environment pane. Click on <code class="language-plaintext highlighter-rouge">gitignore</code>. On a new line add <code class="language-plaintext highlighter-rouge">data</code> and click save. Don’t forget to commit the <code class="language-plaintext highlighter-rouge">.gitignore</code> file.
<img src="../fig/05-gitignore-git-pane.PNG" alt=".gitignore in git pane" /></p>
  </blockquote>
</blockquote>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>R Studio has Git version control functionality built in.</p>
</li>
    
    <li><p><em>Forking</em> a Github repository makes a copy of the repository into your personal account on Github.</p>
</li>
    
    <li><p>You can <em>clone</em> a git repository from Github to your local disk using RStudio.</p>
</li>
    
    <li><p>For this workshop each learner will work with their own <em>fork</em> of the “<a href="https://github.com/UCSBCarpentry/R-repro-pub">R-Repro-pub</a>” repository.</p>
</li>
    
  </ul>
</blockquote>

<hr />

<h1 id="writing-and-styling-qmd-documents" class="maintitle">Writing and Styling Qmd Documents</h1>

<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 10 min
      <br />
      <strong>Exercises:</strong> 10 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>What is the Visual Editor in RStudio?</p>
</li>
	
	<li><p>Which features does the Visual Editor have?</p>
</li>
	
	<li><p>How can I can apply styling and formatting to Qmd documents in Rstudio more easily?</p>
</li>
	
	<li><p>How to add inline code?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Learn how to enable the visual editor.</p>
</li>
	
	<li><p>Get familiar with its basic functionalities.</p>
</li>
	
	<li><p>Apply formatting and styling using the visual editor.</p>
</li>
	
	<li><p>Learn how to add inline code to your qdm document.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="formatting-qmd-documents-with-the-visual-editor">Formatting Qmd Documents with the Visual Editor</h2>

<p>As we mentioned earlier, the visual editor in RStudio makes formatting much more effortless. It provides improved productivity for composing longer-form articles and analyses with Quarto. Markdown documents can be edited in either source or visual mode. To switch into visual mode for a given document, toggle on the visual option at the top-left of the document toolbar (alternatively for windows, the ⌘⇧ F4 keyboard shortcut). This will prompt a formatting bar through which you can apply styling, add links, create tables, and others similar to functions you find in google docs and other document editors. Note that you can switch between source and visual mode at any time (editing location and undo/redo state will be preserved when you switch). Let’s try it! Feel free to follow along or just watch this quick demo. But first, make sure to have your visual editor enabled on your screen. Also, make sure to open your <code class="language-plaintext highlighter-rouge">DataPaper-ReproducibilityWorkshop.qmd</code> file located at the <code class="language-plaintext highlighter-rouge">report</code> folder.</p>

<p>If you’d like to learn more about markdown basics and use the source mode to format you documents check <a href="https://quarto.org/docs/authoring/markdown-basics.html">Quarto’s markdown basics</a>.</p>

<h3 id="editor-toolbar">Editor Toolbar</h3>

<p>The editor toolbar includes buttons for the most commonly used formatting commands:</p>

<p><img src="../fig/06-toolbar.png" alt="Fig. 6.1 - Toolbar" /></p>

<p>Additional commands are available on the Format, Insert, and Table menus:</p>

<p><img src="../fig/06-menu.png" alt="Fig. 6.2 - Menu" /></p>

<blockquote class="callout">
  <h2 id="tip-inserting-anything-with-shortcuts">Tip: Inserting anything with shortcuts</h2>
  <p>You can also use the catch-all ⌘ / shortcut to insert just about anything. Just execute the shortcut then type what you want to insert. For example: <code class="language-plaintext highlighter-rouge">/lis</code> will prompt listing options.</p>

</blockquote>

<p>Let’s get some formatting done in our example paper. We will look for some <strong>Examples</strong> and replace with the recommended style so we can all produce a similar output at the end of the workshop.
<br /></p>

<blockquote class="keypoints">
  <h2 id="rendering-documents">Rendering Documents</h2>
  <p>When you do your first render, the pop-up may be blocked by your browser. You can unblock the pop-up or in the <b>Background Jobs</b> pane,
find the local host url and copy+paste that into your browser.</p>

</blockquote>

<h3 id="applying-emphasis"><em>Applying Emphasis</em></h3>

<p>At the very top of the document we have a recommended citation for the sample data paper (<strong>Example 1</strong>). We want to emphasize the title of the journal, “Data in brief” in italics. Select the text and click in the I icon and voilà! Remember to delete (Example 1).</p>

<h3 id="adding-links"><em>Adding Links</em></h3>
<p>In the same citation we have just worked on, let’s now add a link to it by selecting and copying the doi address (<strong>Example 2</strong>). Then, click on the link icon and paste the address in the URL field. Simple right? If you prefer, you can also the drop-down insert menu, or even use shortcuts. By hovering the mouse over the desired icon, you will see which keys you should use. For a complete list of editing shortcuts, <a href="https://rstudio.github.io/visual-markdown-editing/shortcuts.html">check this link</a>. Tip: if you didn’t intend to use a shortcut and want to reverse its effect, just press the backspace key.</p>

<h3 id="adding-headings"><em>Adding Headings</em></h3>

<p>Adding headings to a a Quarto markdown document in Rstudio is as simple as applying links. Let’s say we want the abstract section as a Heading Level 2. We can select the “abstract” then, and under “Normal” on the left-hand side of the menu, we can choose the desired level. Again, all the shortcuts will be listed next to the styling in the menu. Now apply the same heading to keywords and Level 2 to “Value of the Data” (<strong>Example 3</strong>).</p>

<h3 id="creating-tables"><em>Creating Tables</em></h3>

<p>Because creating tables manually in qmd documents could be a little painful for beginners, Rstudio released an add-in functionality for tables back in 2018. The new visual editor, however, have made the process to create qmd tables more similar to other editors we use daily. In our template, we have the specification table with 10 rows and two columns. If we were willing to add that table, we could do that by inserting a table to a selected part of the documents and by specifying the desired number of rows and columns.  Including a caption is optional, but recommended. We can add or delete rows and columns, add a header that will be set bold by default but can be changed, and set the desired alignment. Select the desired text and click on the crossed T icon if you wish to clear formatting.</p>

<p><img src="../fig/06-clearformatting.png" alt="Clear Formatting Option" /></p>

<h3 id="creating-bullet-and-numbered-lists"><em>Creating Bullet and Numbered Lists</em></h3>

<p>Again, similarly to other document editors, Rstudio allows you to turn text into bullet or numbered lists. Let’s apply a bullet list to the paragraphs specifying the “Values of the Data” reported in the data paper (<strong>Example 4</strong>). Assuming we were willing to create a numbered list instead, we could have followed the same process and chosen the other icon. We can also sink or lift the listed items.</p>

<h3 id="adding-images"><em>Adding Images</em></h3>

<p>You may need to include static images to your manuscripts. For that, you can use the insert image function, click on the painting icon or even use the shortcut that shows right next to the function in the menu. After browsing and upload the desired image you may also specify the caption and the image title, as well as adjust dimensions if needed. Let’s insert image for Fig. 1 (<strong>Example 5</strong>).</p>

<h3 id="adding-formulas"><em>Adding Formulas</em></h3>

<p>If you have math formula in your manuscript there are three different ways you may insert one. Let’s look for (<strong>Example 6</strong>) for an example. Point and click at the insert menu, use the catch-all <code class="language-plaintext highlighter-rouge">⌘ /</code> keyboard short and then get to inline math mode, or type the formula content between dollar signs <code class="language-plaintext highlighter-rouge">$</code>. You will notice that the color and font type will change, as Rstudio identifies the block as an inline equation.</p>

<h2 id="keyboard-shortcuts">Keyboard Shortcuts</h2>
<p>As you become a more regular Rstudio user, you may also consider using some keyboard shortcuts for all basic editing tasks. Visual mode supports both traditional keyboard shortcuts (e.g. <code class="language-plaintext highlighter-rouge">⌘ B</code> for bold) as well as markdown shortcuts (using markdown syntax directly). For example, enclose <strong>bold</strong> text in asterisks or type ## and press space to create a second level heading. Here are some of the most commonly used shortcuts for Mac users:</p>

<p><img src="../fig/06-shortcuts.png" alt="Fig. 6.3 - Shortcuts" /></p>

<p>Tip: Windows users should replace in the shortcuts above <code class="language-plaintext highlighter-rouge">⌘</code> by <code class="language-plaintext highlighter-rouge">ctrl</code> and <code class="language-plaintext highlighter-rouge">⌥⌘</code> by <code class="language-plaintext highlighter-rouge">alt (+) ctrl</code>.</p>

<h2 id="other-editing-features">Other Editing Features</h2>
<p>The visual editor allows users to insert images by browsing their location or copying and pasting it to the Qmd document directly. There are also options to add html, line blocks, blockquotes, and footnotes. Up next we will learn more about how to add code chunks. In further episodes we will also learn how to insert citations and create a bibliography.</p>

<h2 id="bonus-content-more-styling-with-fence-divs-demonstration-only">Bonus Content: More Styling with Fence Divs (Demonstration Only)</h2>

<p>Quarto also allows some cool styling using colons to create <em>fenced divs</em>. The advantage of using fenced divs is that you may section styling/layout to pieces of your content more easily, using an unified and syntax, while also protecting and preserving formatting across different types of outputs. Essentially, these will adopt the following structure:</p>

<ul>
  <li>Start and end with an equal number of colons being minimum of 3 <code class="language-plaintext highlighter-rouge">:::</code></li>
  <li>Add curly brackets to indicate the start/end of a class or name, e.g., <code class="language-plaintext highlighter-rouge">{.class}</code></li>
</ul>

<p>We won’t have time to cover these extensively, but let’s take a look at a few examples.</p>

<h3 id="adding-borders-around-text"><em>Adding borders around text</em></h3>

<p>We can create clusters of content and add a border around the text using a div:</p>

<p>If we type: <br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
::: {.border}

Example of some content with a border.

:::

</code></pre></div></div>

<p>When we render it, we will get: <br /></p>

<p><img src="../fig/06-text-borders.png" alt="Text with borders rendered" /> <br /></p>

<h3 id="dividing-content-into-separate-columns"><em>Dividing content into separate columns</em></h3>

<p>If we want to separate content into two or more columns that could be accomplished with a similar approach as above.</p>

<p>If we type: <br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
:::: {.columns}
::: {.column width="50%"}
Some content in left column
:::
::: {.column width="50%"}
Some Content in right column
:::
::::

</code></pre></div></div>

<p>When we render it, we will get: <br /></p>

<p><img src="../fig/06-twocolumns.png" alt="Two columns rendered" /> <br /></p>

<p>If you would like to explore more the <em>Fence Divs</em> and othere cool Quarto functionalities check their <a href="https://quarto.org/docs/authoring/markdown-basics.html#divs-and-spans">Divs and Spans documentation</a>.</p>

<blockquote class="checklist">
  <h2 id="time-to-commit">Time to Commit!</h2>
  <p>Make sure to render and then commit your changes to GitHub. Add your changed files and commit with the following message: “Added Formatting”</p>
</blockquote>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>The visual editor has made formatting much easier.</p>
</li>
    
    <li><p>You can apply Qmd styling without prior Quarto knowledge.</p>
</li>
    
    <li><p>You can include inline code to narratives for basic calculations and dynamic information.</p>
</li>
    
  </ul>
</blockquote>

<hr />

<h1 id="adding-code-generated-plots-and-figures" class="maintitle">Adding Code-Generated Plots and Figures</h1>

<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 50 min
      <br />
      <strong>Exercises:</strong> 20 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>What is Knitr?</p>
</li>
	
	<li><p>What are code chunks and how they are structured?</p>
</li>
	
	<li><p>How can you run code from your Quarto document?</p>
</li>
	
	<li><p>What are global knitr options?</p>
</li>
	
	<li><p>What are global execution options?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Understand the syntax of a code chunk.</p>
</li>
	
	<li><p>Learn how to insert run-able chunks of code to integrate into your report</p>
</li>
	
	<li><p>Learn how to source external scripts to run within an Quarto document.</p>
</li>
	
	<li><p>Learn about using global knitr options and global execution options</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="code-in-quarto-documents">Code in Quarto Documents</h2>

<p>We’ve learned about the text-formatting options of Quarto, now let’s dive into the code portion of Quarto documents. Quarto flips the defaults of code and text - instead of priortizing the code and making you comment out (#) text such as in R scripts, they priortize text and force you to specially comment the code portions. How do you signal to R the difference between code and text when you’re not using code commments (#)? That’s where code chunks (or “code chunks” as RStudio calls them) come into play. Instead of Quarto’s rendering system processing the markdown styling into the final output, Code chunks are sent to a preceding stage of processing by Knitr, which “knits”/render the code output and text together. Secondly, Quarto processes the code output and displays it in the document format of our choice - i.e. Knitr runs the lines of code for a plot in a code chunk, joins it to the markdown text portions, and Quarto outputs that as an html document.</p>

<h2 id="what-is-knitr">What is Knitr?</h2>

<p>But what is Knitr? Knitr is the engine in RStudio which creates the “dynamic” part of Quarto reports. It’s specifically a package that allows the integration of R code into the html, word, pdf, or LaTex document you have specified as your output for Quarto. It utilizes Literate Programming to make research more reproducible. There are two main ways to process code with Knitr in Quarto documents:</p>

<ol>
  <li>Code Chunks</li>
  <li>Inline Code</li>
</ol>

<p>First, we’re going to talk about code chunks for including substantial portions of code into our narrative such as to generate figures and plots. There are a plethora of options that become available to us when using code chunks so this tends to be the more complex part of Quarto documents. Now, sometimes you just need to do a quick calculation - like a count of total observations in your data or the mean of one of your variables. In those cases, it may not be worth setting up a code chunk to calculate those values, so after code chunks we will see how to add inline code - which allows one to add a quick line of code or single function to be executing within the text portion of the document. But let’s start with code chunks.</p>

<h2 id="using-code-chunks">Using Code Chunks</h2>

<p>Code chunks (also called “code blocks”) are the preferred option when you need to do something more sophisticated with your code than inline code, such as building plots or tables.  They also incorporate syntax which allows modifications to how that code is rendered and styled in your final output. We’ll learn more about that as we walk through the “anatomy” of a code chunk.</p>

<h3 id="add-a-code-chunk">Add a Code Chunk</h3>

<p>Ok, let’s add some code! There are already some plots included in our code but as static images. Now, we will add some additional plots, but generated straight from R code - which are also more reproducible and easier to update than static images. Using code to generated images directly assures us that if there are any changes to the data or code the plots will update automatically. We also don’t have to generate the new plots, save them as images, and then add them back in to our paper. Not only is this a time-saver, but it helps to prevent version errors as well!</p>

<p>Navigate to the end of the paper where it says <strong>“Example 8”</strong>. This is where we will add our first code chunk.</p>

<p>Let’s all start a new code chunk by typing our our starting backticks &amp; r between curly brackets or by using the buttons available in the editor toolbar.</p>

<blockquote>
  <p><img src="../fig/07-auto-code-chunk.PNG" alt="auto create code chunk" /></p>
</blockquote>

<blockquote class="callout">
  <h2 id="tip-four-ways-to-insert-code-chunks">Tip: Four ways to insert code chunks</h2>
  <ul>
    <li>the Add Chunk button in the editor toolbar  (looks like a green square with a C)</li>
    <li>the Insert &gt; Code Chunk menu option in the editor toolbar</li>
    <li>by typing the code chunk delimiters {r} and ```. *If you are in “editor” mode you will need to remember to end the code chunk with ending backticks as well ```.</li>
    <li>the keyboard shortcut 
    - Ctrl + Alt + I (Windows)
    - Cmd + Option + I (Mac)</li>
  </ul>
</blockquote>

<h3 id="basic-anatomy-of-a-code-chunk">Basic Anatomy of a Code Chunk</h3>

<p>The most basic (empty) code chunk looks like so:</p>

<p><img src="../fig/08-blank-code-chunk.png" alt="blank qmd code chunk" /></p>

<p>Other than backticks ``` for code chunks that surround the code top and bottom, the only <strong>required</strong> piece is the specified language (r) placed between the curly brackets. This indicates that the language to read the code is R.</p>

<blockquote class="callout">
  <h2 id="fun-fact-other-programming-languages">Fun fact: Other Programming Languages</h2>
  <p>Although we will (mostly) be using R in this workshop, it’s possible to use other programming or markup languages. For example, we have seen that we can use LaTeX code for equations. You can also use python and a handful of other languages, so if R is not your preferred programming, but you like working in the RStudio environment, don’t despair! Other options for languages include: sql, julia, bash, and c, etc. It should be noted however, that some languages (like python) will require installing and loading additional packages.</p>
</blockquote>

<h2 id="add-the-code-to-our-paper">Add the code to our Paper</h2>

<p>Now, let’s open our <code class="language-plaintext highlighter-rouge">03_HR_analysis.R</code> script in our <code class="language-plaintext highlighter-rouge">code</code> folder. We will insert the code of this script into our current working file. To do this, copy the code and paste it in-between the two lines with backticks and <code class="language-plaintext highlighter-rouge">{r}</code>.</p>

<p><img src="../fig/07-heartrate-code.PNG" alt="heartrate code in chunk" /></p>

<h2 id="run-the-code-in-a-code-chunk">Run the code in a code chunk</h2>
<p>Now, to check to make sure our code renders, we could click the “Render” button as we have been doing to check on the output of our Quarto file. However, with code chunks we have other options for running and debugging code that don’t require us to wait for the file to render.</p>

<p>1) Run from code chunk (green play button on the right top corner). This allows us to run one specific code chunk.</p>

<p><img src="../fig/07-run-from-chunk.png" alt="run from code chunk" /></p>

<p>2) Run menu - this gives more options for running code chunks (chunks) including the current one, the next one, all chunks, etc.</p>

<p><img src="../fig/07-run-options.png" alt="run code menu" /></p>

<p>3) Keyboard shortcuts:</p>

<table>
  <thead>
    <tr>
      <th><strong>Task</strong></th>
      <th><strong>Windows &amp; Linux</strong></th>
      <th><strong>macOS</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Create a code chunk</td>
      <td>Ctrl + Alt + I</td>
      <td>Cmd + Option + I</td>
    </tr>
    <tr>
      <td>Run all chunks above</td>
      <td>Ctrl+Alt+P</td>
      <td>Command+Option+P</td>
    </tr>
    <tr>
      <td>Run current chunk</td>
      <td>Ctrl+Alt+C</td>
      <td>Command+Option+C</td>
    </tr>
    <tr>
      <td>Run current chunk</td>
      <td>Ctrl+Shift+Enter</td>
      <td>Command+Shift+Enter</td>
    </tr>
    <tr>
      <td>Run next chunk</td>
      <td>Ctrl+Alt+N</td>
      <td>Command+Option+N</td>
    </tr>
    <tr>
      <td>Run all chunks</td>
      <td>Ctrl+Alt+R</td>
      <td>Command+Option+R</td>
    </tr>
    <tr>
      <td>Go to next chunk/title</td>
      <td>Ctrl+PgDown</td>
      <td>Command+PgDown</td>
    </tr>
    <tr>
      <td>Go to previous chunk/title</td>
      <td>Ctrl+PgUp</td>
      <td>Command+PgUp</td>
    </tr>
  </tbody>
</table>

<p>Run your code with one of the given methods.</p>

<p>Well shoot! We’re getting an error:</p>

<p><img src="../fig/07-path-code-error.png" alt="directory error code chunk" /></p>

<p>If we go to the bottom of the code chunk we’ll see more details on the error:</p>

<p><img src="../fig/07-path-error-details.png" alt="path error details" /></p>

<p>This is a path error. The reason we’re seeing this is that our paper is located in the report/source directory while our test document was automatically created in the project root directory. The path from the report/source directory to the data we’re trying to read is not correct any longer.</p>

<h3 id="fixing-relative-path-errors">Fixing Relative Path Errors</h3>

<p>We can fix this by adding the correct relative path:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>df &lt;- read_csv("../output/data/preprocessed-GARP-TSST-data.csv")
</code></pre></div></div>
<p>Instead of:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>df &lt;- read_csv("output/data/preprocessed-GARP-TSST-data.csv")
</code></pre></div></div>

<p>Run the code again to make sure it works properly.</p>

<p>Did it work? Look under the code chunk. You should now see a plot preview displayed beneath the code chunk if all went well.</p>

<p><img src="../fig/07-plot-preview.png" alt="Code Chunk Plot Preview" /></p>

<h2 id="rendering-code-chunks">Rendering Code Chunks</h2>

<p>We just saw how to run our code in our code chunks to test that it works and to see a preview of the code output that will render in our html document but to <em>actually</em> render the final we need to use the Render button as with. Using the <code class="language-plaintext highlighter-rouge">Render</code> button with code chunks is a two step process - first the code is run (all code chunks will run automatically). Second, (if there are no code errors) the document of choice will render for our whole Quarto document.</p>

<blockquote class="checklist">
  <h2 id="time-to-render">Time to Render!</h2>
  <p>Now, let’s Render the Quarto file and see how our code output looks in the final html page.</p>
</blockquote>

<p><img src="../fig/07-render.png" alt="code chunk with plot1 code" /></p>

<p>Wait… what’s all that output in our document? We don’t want that in our paper!</p>

<p><img src="../fig/07-HR-output-no-options.PNG" alt="Heart rate code no options for code chunk" /></p>

<p>This happens because the output from running code (messages, results, warnings, etc.) get’s added to the Quarto document instead of being printed to the console. Let’s see about adjusting the output to make it look better with code chunk rendering options.</p>

<h2 id="code-chunk-options">Code Chunk Options</h2>

<p>There are over 50 different code chunk options!!! Obviously we will not go over all of them, but they fall into several larger categories including: code evaluation, text output, code style, cache options, plot output and animation. We’ll talk about a few options for code evaluation, text output and plot output specifically.</p>

<p>Code chunk options in Quarto are added within code chunks and always have the following format:</p>

<p><code class="language-plaintext highlighter-rouge">#| option: option-text</code></p>

<h3 id="common-code-chunk-options">Common code chunk options:</h3>

<p><strong>include</strong> = (logical) whether to include the chunk output in the output document (defaults to TRUE).<br />
<strong>eval</strong> = (logical or numeric) TRUE/FALSE to evaluate (or not) or a numeric value like c(1,3) (only evaluate expressions 1 and 3). <br />
<strong>echo</strong> =  (logical or numeric - following the same rules as above) whether to display source code or not.<br />
<strong>results</strong> = (logical or character) text output of the code can be hidden (hide or FALSE), or delineated in a certain way (default ‘markup’).     <br />
<strong>warning</strong> = (logical) whether to display the warnings in the output (default TRUE). FALSE will output warnings to the console only.     <br />
<strong>message</strong> = (logical) whether or not to display messages that appear when running the code (default TRUE).</p>

<h4 id="using-code-chunk-options-for-clean-quarto-documents">Using code chunk options for clean Quarto Documents</h4>

<p>Ok, let’s use some of the options above to improve the look of our Quarto document. Add the following options one-by-one to see how they change your output (click <code class="language-plaintext highlighter-rouge">Render</code> after each option you add):</p>

<ul>
  <li>echo: false</li>
  <li>message: false</li>
  <li>warning: false</li>
  <li>results: false</li>
</ul>

<p>These options mean the source code will not be printed in the rendered html document, messages from the code will not be printed in the rendered html document, and warnings will not be printed in the html document (but will still output to the console). Plots, figures or whatever is printed by the code WILL show up in the final html document.</p>

<p>Now we are seeing what we would like: a figure without other output to show in our paper.</p>

<blockquote class="challenge">
  <h2 id="challenge-71---rendering-codes-optional">CHALLENGE 7.1 - Rendering Codes (optional)</h2>
  <p>How will some hypothetical code render given the following options?</p>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{r}
#| label: global-chunk-challenge
#| eval: true
#| include: false
</code></pre></div>  </div>

  <blockquote class="solution">
    <h2 id="solution">SOLUTION</h2>
    <p>The expressions in the code chunk will be evaluated, but the outputed figures/plots will not be included in the rendered document. <br />
When might you want to use this? <br />
If you need to calculate some value or do something on your dataset for a further calucation or plot, but the output is not important to be included in your paper narrative.</p>
  </blockquote>
</blockquote>

<blockquote class="callout">
  <h2 id="tip">Tip:</h2>
  <p>Find a complete list of code chunk options on Knitr developer, Yihui Xie’s, <a href="https://yihui.org/knitr/options/">online guide to knitr</a>.</p>
</blockquote>

<h3 id="label-your-code-chunk">Label Your Code Chunk</h3>

<p>Before we get to fixing how our code output looks, let’s pause a second and give our code chunk a label. While not required for running your code, it is good practice is to give a name to each code chunk because a label is an unique identifier which allows for more advanced options (such as cross-referencing) to work with your qmd files later on:</p>

<p><img src="../fig/07-code-label.png" alt="code chun k label" /></p>

<p>Some things to keep in mind</p>
<ul>
  <li>The chunk label syntax is always <code class="language-plaintext highlighter-rouge">#| label: chunk-label</code> with <code class="language-plaintext highlighter-rouge">chunk-label</code> replaced with your own text</li>
  <li>The chunk label has to be unique (i.e. you can’t use the the same name for multiple chunks)</li>
</ul>

<p>We’ll see in a bit where this code chunk label comes in handy. But, for now let’s go back and give our first code chunk a name:</p>

<p><code class="language-plaintext highlighter-rouge">#| label: fig3-heartrate</code></p>

<blockquote class="callout">
  <h2 id="tip-dont-use-spaces-periods-or-underscores-in-code-chunk-labels">Tip: Don’t use spaces, periods or underscores in code chunk labels</h2>
  <p>Avoid spaces, periods <code class="language-plaintext highlighter-rouge">(.)</code>, and underscores <code class="language-plaintext highlighter-rouge">(_)</code> in chunk labels and paths. If you need separators, you are recommended to use hyphens <code class="language-plaintext highlighter-rouge">(-)</code> instead. For example, setup-options is a good label, whereas setup.options and chunk 1 are bad; fig.path = ‘figures/mcmc-‘ is a good path for figure output, and fig.path = ‘markov chain/monte carlo’ is bad. See more at: <a href="https://yihui.org/knitr/options/">https://yihui.org/knitr/options/</a></p>
</blockquote>

<h3 id="caption-your-code-chunk-output">Caption your code chunk output:</h3>

<p>The options we just looked at focus on code evaluation and text output. However, we have another set of options that deal with how plot or figure outputs look at act. Many of the options start with <code class="language-plaintext highlighter-rouge">fig</code>. The one we will use today allows us to add a caption to our figure. Again, this is an optional feature, but if you need (or want) to add captions to your publication, it is straightforward to do in code chunks.</p>

<p>The caption information also resides at the top of a code chunk using the <code class="language-plaintext highlighter-rouge">#|</code> syntax as such:</p>

<p><code class="language-plaintext highlighter-rouge">#| fig.cap: "Figure Caption Here"</code></p>

<p><strong>Don’t forget to put the caption within quotes <code class="language-plaintext highlighter-rouge">""</code>.</strong></p>

<blockquote class="challenge">
  <h2 id="challenge-72-add-a-caption-to-figure-3">CHALLENGE 7.2: Add a caption to Figure 3</h2>
  <p>Let’s add a caption to our heartrate figure. Add the caption:</p>

  <p>“Fig 3: Mean heart rate of stress and control groups at baseline and during intervention.”</p>
  <blockquote class="solution">
    <h2 id="solution-1">SOLUTION</h2>
    <p>so, you should end up with the following in your code chunk:</p>
    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="n">r</span><span class="p">}</span><span class="w">
</span><span class="c1">#| label: fig3-heartrate</span><span class="w">
</span><span class="c1">#| echo: false</span><span class="w">
</span><span class="c1">#| message: false</span><span class="w">
</span><span class="c1">#| warning: false</span><span class="w">
</span><span class="c1">#| results: false</span><span class="w">
</span><span class="c1">#| fig.cap: "Fig 3: Mean heart rate of stress and control groups at baseline and during intervention."</span><span class="w">
</span></code></pre></div>    </div>
    <p>Set the option <code class="language-plaintext highlighter-rouge">fig.cap</code> to equal the text in double quotes.</p>
  </blockquote>
</blockquote>

<h2 id="more-plotfigure-options">More plot/figure options</h2>
<blockquote class="callout">
  <p>Other options that change how a plot or figure appears often use the sytax <code class="language-plaintext highlighter-rouge">fig.xxx</code> similar to <code class="language-plaintext highlighter-rouge">fig.cap</code> Some other useful plot/figure code options include (From <a href="https://yihui.org/knitr/options/#plots">Yihui Xie’s page</a> ):</p>
  <ul>
    <li><code class="language-plaintext highlighter-rouge">fig.width</code>, <code class="language-plaintext highlighter-rouge">fig.height</code>: (both are 7; numeric) Width and height of the plot (in inches), to be used in the graphics device.</li>
    <li><code class="language-plaintext highlighter-rouge">out.width</code>, <code class="language-plaintext highlighter-rouge">out.height</code>: (NULL; character) Width and height of the plot in the output document, which can be different with its physical fig.width and fig.height, i.e., plots can be scaled in the output document.</li>
    <li><code class="language-plaintext highlighter-rouge">fig.align</code>: (‘default’; character) Alignment of figures in the output document. Possible values are default, left, right, and center. The default is not to make any alignment adjustments.</li>
    <li><code class="language-plaintext highlighter-rouge">fig.link</code>: (NULL; character) A link to be added onto the figure.</li>
    <li><code class="language-plaintext highlighter-rouge">fig.alt</code>: (NULL; character) The alternative text to be used in the alt attribute of the <img /> tags of figures in HTML output. By default, the chunk option fig.cap will be used as the alternative text if provided.</li>
  </ul>
</blockquote>

<p>Let’s render one more time to see if our figure outputs how we’d like and has a caption.</p>

<blockquote class="checklist">
  <h2 id="time-to-render-1">Time to Render!</h2>
  <p>Let’s try that again</p>
</blockquote>

<h2 id="inline-code">Inline Code</h2>

<p>What if you only need to make a quick calculation and adding a code chunk seems a little overkill?</p>

<p>You can directly include code into the text portion of your document with inline code, for example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>There are ` r sum(1:14) ` cats in the neighbourhood
</code></pre></div></div>

<p>We’ve had to put an extra space between the backticks ` and the code to prevent it from rendering so you can understand how to write inline code. You can copy that line into the test-code.qmd document then remove the spaces. If we render the test-code.qmd document, what change do we see?</p>

<p>Say you are discussing some of the summary statistics in your manuscript, Quarto makes this possible through HTML/LaTeX inline code which allows you to calculate simple expressions integrated to your narrative. Inline code enables you to insert <code class="language-plaintext highlighter-rouge">r code</code> into your document to dynamically updated portions of your text. In other words, if your data set changes for any reason the code will automatically update the calculation specified.</p>

<p>This can be helpful when referring to specific variables on your data. For example, you should include numbers that are derived from the data as code not as numbers. Thus, rather than writing “The CSV file contains choice consistency data for 10.000 simulated participants” <strong>(Example 7)</strong> , replace the static number with a bit of code that, when evaluated, gives you a dynamic number if anything changes on your dataset. Note that there is not an insert option to do this from the menu in the visual editor, so we need to insert inline code manually with  <code class="language-plaintext highlighter-rouge">r</code>, for example:</p>

<p>The CSV file contains choice consistency data for <code class="language-plaintext highlighter-rouge">r nrow(bronars_simulation_data)</code> simulated participants.</p>

<p>When you render you might get an error. Any idea why? That is because we need to make sure to import the dataset we are referring to before the inline code can work. Let’s add the following to our chunk at the beginning of the document where we loaded our other data:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bronars_simulation_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/bronars_simulation_data.csv"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<blockquote class="checklist">
  <h2 id="time-to-render-2">Time to Render!</h2>
  <p>If you update your dataset this value will match the number of rows.</p>
</blockquote>

<blockquote class="challenge">
  <h2 id="challenge-73---adding-inline-code">CHALLENGE 7.3 - Adding inline code</h2>
  <p>Suppose we would like to add some information to the sentence we have just adjusted in our manuscript. We would like to include the average for the variable <em>violation_count</em> present in the same dataset. Which inline code we would have to add to following sentence?</p>

  <p>The CSV file contains choice consistency data for ` <code class="language-plaintext highlighter-rouge">r nrow(bronars_simulation_data.csv)</code> ` simulated participants, that have been used to determine the power of our food-choice task design to detect choice consistency violations, which averaged ` <code class="language-plaintext highlighter-rouge">enter inline code here</code> `. 
What inline code would you enter? What number would replace the inline code?</p>

  <p>Tip: we will need to use a <code class="language-plaintext highlighter-rouge">dataset$variable</code> syntax!</p>

  <blockquote class="solution">
    <h2 id="solution-2">Solution:</h2>
    <p>` <code class="language-plaintext highlighter-rouge">r mean(bronars_simulation_data$violation_count)</code> `
5.3924</p>
  </blockquote>
</blockquote>

<blockquote class="callout">
  <h2 id="important-note">Important Note:</h2>
  <p>Make sure the file you are calling is in the right subdirectory and your working directory is set appropriately.</p>

</blockquote>

<blockquote class="callout">
  <h2 id="more-on-inline-codes">More on inline codes:</h2>
  <p>Quarto will always display the results of inline code, but not the code. Inline expressions do not take knitr options.</p>

</blockquote>

<blockquote class="checklist">
  <h2 id="time-to-commit">Time to Commit!</h2>
  <p>Now, let’s commit the changes you have made.</p>
</blockquote>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Knitr will render your code and markdown-formatted text and output your document format of choice</p>
</li>
    
    <li><p>Code chunks are runable piece of R code. Each time you render/knit the document, calculations and plots will be run and displayed</p>
</li>
    
    <li><p>Options for code chunks can be set at the individual level or at the global level</p>
</li>
    
  </ul>
</blockquote>

<hr />

<h1 id="reproducible-efficient-methods-of-using-code-chunks" class="maintitle">Reproducible &amp; Efficient Methods of Using Code Chunks</h1>

<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 50 min
      <br />
      <strong>Exercises:</strong> 20 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How can I enhance reproducibility amongst collaborators, present and future?</p>
</li>
	
	<li><p>How do I run external scripts in an Quarto document?</p>
</li>
	
	<li><p>How can I avoid issues with relative paths?</p>
</li>
	
	<li><p>How can I get my Quarto document to render faster?</p>
</li>
	
	<li><p>What is inline code and when to use it?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Learn how to use renv in an RStudio project</p>
</li>
	
	<li><p>Learn how to source external scripts to run within an qmd document to modularize your code.</p>
</li>
	
	<li><p>Learn about using global knitr options to change your <code class="language-plaintext highlighter-rouge">.qmd</code> file’s working directory.</p>
</li>
	
	<li><p>Learn how to load libraries and data for use throughout the whole <code class="language-plaintext highlighter-rouge">.qmd</code> document.</p>
</li>
	
	<li><p>Learn the syntax for inline code.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="reproducible-methods-for-coding-in-quarto">Reproducible Methods for Coding in Quarto</h2>

<p>Now that we’ve learned the core benefit of using Quarto documents - the integration of code with text - let’s learn some next level methods of working with code in Quarto. We’ll cover how to use virtual environments with renv, how to add Global Knitr options to the yaml, run external R scripts from within the Quarto document, setting the working directory for the Quarto document and loading packages and data globally. Whew! that’s a lot! Let’s dig in.</p>

<h2 id="enhancing-reproducibility-with-renv">Enhancing reproducibility with renv</h2>

<p>renv is an R package that keeps track of your project’s dependencies, specifically, the version of the R interpreter your project is using and the versions of any packages referenced by your R scripts.  renv can also download and install package versions according to a project’s requirements.  This makes it easy for a downstream user to run an R project in the same environment in which it was originally developed.</p>

<p>In our workshop project, renv has already been set up— you can tell by the presence of a file <code class="language-plaintext highlighter-rouge">renv.lock</code> in the project’s root directory.  This file records package versions and other information.</p>

<p>Every time you open a project for which renv has been set up, renv automatically runs and checks that the package versions you have installed on your computer match those of the project.  If they match, there is nothing to do (perhaps that was the case for you today).  But if there are any mismatches (as might have happened to you today), renv will print a warning resembling the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* Project '~/Desktop/myproject' loaded. [renv 0.16.0]
* The project library is out of sync with the lockfile.
* Use `renv::restore()` to install packages recorded in the lockfile.
</code></pre></div></div>

<p>If this happens, simply run <code class="language-plaintext highlighter-rouge">renv::restore()</code> from the console pane to download and install the package versions needed to match the project’s requirements.  For example, if the project uses tidyverse 1.3.2 and you have an older version tidyverse 1.3.1 installed on your computer, renv will upgrade your RStudio installation to tidyverse 1.3.2.  (This works conversely as well: if the project uses an older version of a package you have installed, renv will attempt to download and install the older version for you.  Don’t worry about losing the newer version.  renv ensures that all versions of all packages remain installed on your computer, available to be used by projects as needed.)</p>

<p>A few more points on using renv.  To start using renv on a new project, run these commands in the console pane:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>install.packages("renv")
library(renv)
renv::init()
</code></pre></div></div>

<p>This creates the initial <code class="language-plaintext highlighter-rouge">renv.lock</code> file.  Then, whenever you start using a new package (or otherwise change your project’s dependencies), run <code class="language-plaintext highlighter-rouge">renv::snapshot()</code> to update the lockfile.  Finally, if you are using git and start using renv, you will notice that renv creates several files and directories in addition to <code class="language-plaintext highlighter-rouge">renv.lock</code>. For reproducibility, be sure to commit the <code class="language-plaintext highlighter-rouge">renv.lock</code> file, and also <code class="language-plaintext highlighter-rouge">.Rprofile</code> and <code class="language-plaintext highlighter-rouge">renv/activate.R</code>.</p>

<h2 id="global-quarto-options">Global Quarto Options</h2>

<p>We’ve seen that we have pretty fine-tuned control of how our code output looks in our document using code chunk options. Now, let’s learn how to take those controls to the next level by learning how to apply them “globally” over our whole document or even all the documents in your project.</p>

<p>What are some of features of global knitr options? There are many, but we’ll cover several of the most relevant and useful ones here:</p>
<ol>
  <li>Set global options for code chunks so we don’t have to repeat them in each chunk</li>
  <li>Set working directory so file paths (for code chunks) are easier to work with</li>
  <li>Load libraries and data once at the beginning of the document instead of in each code chunk (more concise and less rendering time)</li>
</ol>

<h3 id="project-level-vs-document-level-settings">Project level vs Document level settings</h3>

<p>With Quarto we have the functionality and flexibility of being able to define <em>project</em> level global settings in addition to <em>document</em> level settings. This means that the settings we choose will be applied to either one specific Quarto document or <em>all</em> Quarto documents within our R project.</p>

<p>How do we use document level settings?. How do we edit project level settings? That’s where the yaml at the top of our documents and/or the <code class="language-plaintext highlighter-rouge">_quarto.yml</code> file that lives in our project root directory comes in.</p>

<p>At the top of our .Qmd document we see the yaml:</p>

<p><img src="../fig/08-yaml-header.png" alt="Qmd yaml header" /></p>

<p>Opening the <code class="language-plaintext highlighter-rouge">_quarto.yml</code> file in our project root we see the following default settings:</p>

<p><img src="../fig/08-quarto.yml-new.png" alt="New Quarto yml file" /></p>

<h3 id="project-and-document-settings-hierarchy">Project and Document settings Hierarchy</h3>

<p>Similar to CSS, Quarto uses a cascading style of options. Starting from the project-level <code class="language-plaintext highlighter-rouge">_quarto.yml</code> document, Quarto gathers all specified options ending with the document-level options. All are combined and applied to the specific Quarto document. If there are any options that differ between the documents, the more specific option wins - i.e. the document-level option will be applied.</p>

<p><img src="../fig/08-cascading-options.png" alt="options hierarchy" /></p>

<h2 id="document-level-setting">Document level setting</h2>

<h3 id="global-code-chunk-options">Global Code Chunk Options:</h3>

<p>There is an option to globally set options for the entire Quarto document rather than have to specify in each code chunk. This is helpful when you consistently want to use the same options and when you have many code chunks within a document. Additionally, adding global code options will allow you and collaborators to have a better idea of how you’ve configured your document.</p>

<p>In Quarto, the way to configure global code chunk options is in the yaml header.</p>

<p>In the yaml header of our document we can set global options with <code class="language-plaintext highlighter-rouge">execute</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~~~
...
execute: 
      echo: false
~~~
</code></pre></div></div>

<p>Additional options can be further nested under execute.</p>

<p>Let’s see how it looks in our paper to add the options from our first code chunk:</p>

<p><img src="../fig/08-global-code-options.png" alt="global Quarto code options" /></p>

<blockquote class="callout">
  <h2 id="tip-r-markdown-global-options-syntax-works-in-quarto">Tip: R Markdown global options syntax works in Quarto</h2>
  <p>If you’ve previously used R Markdown and have old documents or don’t want to learn a new workflow quite yet, Quarto is backwards compatible with R Markdown, so you may also use the old <code class="language-plaintext highlighter-rouge">chunk$set</code> syntax as below:
<img src="../fig/07-setup-chunk.png" alt="R Markdown global code options" /></p>

</blockquote>

<blockquote class="callout">
  <h2 id="tip-overiding-global-options">Tip: Overiding global options</h2>
  <p>What if you want most of your code chunks to render with the same options (i.e. echo: false), but you just have one or two chunks that you want to tweak the options on (i.e. display code with echo: true)? Good news! The global options can be overwritten on a case by case basis in each individual code chunk. Test this by adding <code class="language-plaintext highlighter-rouge">#| echo: true</code> to your code chunk in your document and rendering. Did you override the global settings successfully?</p>
</blockquote>

<blockquote class="challenge">
  <h2 id="challenge-81-optional-global--individual-code-chunk-options">Challenge 8.1 (optional) global &amp; individual code chunk options</h2>

  <p>How would appear in our html document if we render a code chunk with the following options?</p>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{r} 
#| warning: true
#| echo: true
...
</code></pre></div>  </div>

  <p>…considering the global chunk settings were as listed:</p>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~~~
execute:
     echo: false
     include: false
~~~
</code></pre></div>  </div>
  <blockquote class="solution">
    <h2 id="solution">SOLUTION</h2>
    <p>In this case, the global settings are set so neither the code nor the output will display. However, the individual chunk reverses the echo setting so the code will display, and it also indicates that any warnings the code renders should output too. The outputs of the code would still not be displayed (include: false) The hypothetical situation for this configuration may be for debugging while writing the qmd document.</p>
  </blockquote>
</blockquote>

<h2 id="project-level-settings">Project level settings</h2>

<h3 id="set-working-directory-to-project-directory">Set working directory to project directory:</h3>

<p>Ok, so you know how we had to change the file path in the code chunk we copied into our document so that the relative path was correct for reading in data? This happened because in Quarto documents, the working directory is wherever the qmd document is located but our code is located in a different folder. This means they have different relative paths to locate and read the data we want to work with. We can simplify things by designating the working directory for our document relative to the root project directory instead. What this does is let all files work relative to the project root instead of each other, standardizing the relative paths. Note that this is mainly important for code chunks - text portions of Quarto documents are not affected. This will clear up some of our confusion with relative paths across our whole R project.</p>

<p>So one should learn how to accomplish that by changing the working directory at the project level yaml settings. So we’ll navigate to our _quarto.yml document in our root project directory and open it.</p>

<p>We’ll add the following settings to the yml file:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
project: 
  execute-dir: project
...
</code></pre></div></div>

<p>So the yml file should now look something like this:</p>

<p><img src="../fig/08-quarto.yml-project.png" alt="Quarto yml project setting" /></p>

<blockquote class="callout">
  <h2 id="note-r-markdown-method-for-setting-working-directory-also-works-in-quarto">Note: R Markdown method for setting working directory also works in Quarto</h2>

  <p>Again, all R Markdown syntax is backward compatible with Quarto so it is possible to use the “old” method to set the working directory. This would be the workaround to set the working directory if you don’t wish to use the Quarto project <code class="language-plaintext highlighter-rouge">_quarto.yml</code> file.</p>

  <p>To simplify it further, one can use the <code class="language-plaintext highlighter-rouge">here</code> package available in RStudio.</p>

  <p>This is a setting option in  global knitr settings. The following code would be used in a code chunk at the top of your Quarto document:</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>knitr::opts_knit$set(root.dir = here::here())
</code></pre></div>  </div>
</blockquote>

<p>Now, we would change the relative path in our code chunk back to what it was before, but let’s hold tight. We’re going to introduce another way to run code! But first, let’s see how to globally load data and packages.</p>

<blockquote class="callout">
  <h2 id="note-changing-the-working-directory-only-applies-to-code">Note: Changing the working directory only applies to code</h2>
  <p>Setting the working directory to the project directory we just did adjusts the working directory for all code in the Quarto document (code chunks and inline code), but NOT for any markdown text elements (images and hyperlinks).</p>
</blockquote>

<blockquote class="callout">
  <h2 id="tip-yaml-chunk-options">Tip: Yaml chunk options</h2>
  <p>We can also tweak some settings in our yaml which changes how code chunks are displayed. We’re not going to get into this in the workshop, but many of the same options you set in your global code chunk settings are also configurable in the yaml.</p>
</blockquote>

<h2 id="code-improvements">Code improvements</h2>

<h3 id="globally-load-data-and-packages">Globally load data and packages</h3>

<p>We can improve organization and rendering speed in our documents by learning how to globally load data and packages. So far we’ve loaded the library <code class="language-plaintext highlighter-rouge">tidyverse</code> and the data frame <code class="language-plaintext highlighter-rouge">df</code> we need in the first code chunk. Now if we want to add another figure (say the hormone analysis code ‘02_hormone_analysis.r`), which uses the same data as our first figure - we would be loading tidyverse and the data for a second time. This is unnecessary because once libraries and data are loaded in a Quarto document they are available for use in the rest of the code in the document following.</p>

<p>Best practice is to load libraries and data once at the beginning of our document making it available for all other figures or calculations throughout the document -  allowing us to avoid repetition in our code and saving us rendering time. This also makes it easier for us to keep track of all the libraries and data we need to use in any given document for ourselves and collaborators. If anything needs to be tweaked, we don’t need to search through every code chunk in our qmd document to make a change - it’s listed right at the top.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># load libraries</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">BayesFactor</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">patchwork</span><span class="p">)</span><span class="w">

</span><span class="c1"># load data</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./output/data/preprocessed-GARP-TSST-data.csv"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<blockquote class="challenge">
  <h2 id="challenge-82-order-matters-optional">Challenge 8.2: Order matters (optional)</h2>

  <p>What would happen if we loaded the data before we loaded the libraries?
Try it out!</p>

  <blockquote class="solution">
    <h2 id="solution-1">Solution:</h2>

    <p>We would get an error because we haven’t loaded tidyverse yet!
<img src="../fig/08-error-load-data.png" alt="load data error" /></p>
  </blockquote>
</blockquote>

<p>At this point we could go back through our R scripts and comment out (or delete) the beginning sections where we load the data and libraries (you will see this is already done in most of the scripts in the code folder). You can imagine that the more code chunks you have the more time taking this step would save. Bonus that this also works to load the data before it is called in inline code as well!</p>

<h2 id="run-code-from-an-external-script-in-a-code-chunk">Run Code from an external script in a code chunk</h2>

<p>Let’s learn another technique for adding code-generated plots and figures into our document. This time around let’s see how to run code in a code chunk from an external R script instead of somewhat awkwardly copying and pasting the code from a R script to a code chunk in our <code class="language-plaintext highlighter-rouge">.qmd</code>.</p>

<p>There are at least a few benefits to running code in this modular fashion instead of copy/pasting:</p>
<ol>
  <li>
    <p>Automatic updates: if the code gets updated in the R script, it will automatically be updated in the Quarto document as well. We won’t need to copy/paste code updates, which would make it easy to end up with discrepancies between our <code class="language-plaintext highlighter-rouge">.r</code> scripts and our <code class="language-plaintext highlighter-rouge">.qmd</code> paper.</p>
  </li>
  <li>
    <p>Readability: calling code externally only takes several lines of code - versus copy/pasting 50+ lines of code from our scripts.</p>
  </li>
  <li>
    <p>Less fussing with relative paths* - we had to change the code slightly in the first example to update the file path to the data set, which introduces variations and inconsistencies. With this method we won’t have to modify the source code.</p>
  </li>
</ol>

<p>*unfortunately you will never be free of relative paths, but you can make it a bit easier on yourself.</p>

<p>Again, let’s test this out in our generic Quarto document. After our first figure add a new code chunk:</p>

<p><img src="../fig/08-blank-code-chunk.png" alt="basic code chunk" /></p>

<p>We’re just going to test out the same figure again so we can verify this new method works. So in the heart rate anlysis code chunk, delete the existing code and add the following instead:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># run the code from 03_HR_analysis.R in the code directory</span><span class="w">
</span><span class="n">source</span><span class="p">(</span><span class="s2">"code/03_HR_analysis.R"</span><span class="p">,</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">knitr</span><span class="o">::</span><span class="n">knit_global</span><span class="p">())</span><span class="w">
</span><span class="c1"># display the plot created by code in 03_HR_analysis.R</span><span class="w">
</span><span class="n">plot</span><span class="w"> 
</span></code></pre></div></div>

<h3 id="add-the-code-to-our-quarto-document">Add the code to our Quarto document</h3>

<p>First, find <code class="language-plaintext highlighter-rouge">Example 8</code> in the Quarto document for Fig 3 (ctrl-f “Example 8”).</p>

<p>Add the following code where <code class="language-plaintext highlighter-rouge">Example 8</code> is located under “Preview of Research Results”.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># run the code from 03_HR_analysis.R in the code directory</span><span class="w">
</span><span class="n">source</span><span class="p">(</span><span class="s2">"code/03_HR_analysis.R"</span><span class="p">,</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">knitr</span><span class="o">::</span><span class="n">knit_global</span><span class="p">())</span><span class="w">
</span><span class="c1"># display the plot created by code in 03_HR_analysis.R</span><span class="w">
</span><span class="n">plot</span><span class="w"> 
</span></code></pre></div></div>

<p>It should look like this:</p>

<p><img src="../fig/08-HR-external-code.png" alt="03-HR-analysis.R externally sourced in Qmd Document" /></p>

<p>DON’T forget to add chunk name and caption for Figure 3 (we can use the same name and caption as before). Remember we don’t need to add options since we defined them globally.</p>

<blockquote class="checklist">
  <h2 id="time-to-run">Time to Run!</h2>
  <p>Let’s see if our code worked when generated from an external script</p>
</blockquote>

<blockquote class="checklist">
  <h2 id="time-to-render">Time to Render!</h2>
  <p>If the code ran without error, let’s render the whole document again and take a look.</p>
</blockquote>

<p>Our plot should look exactly the same as the first copy-pasted one.</p>

<p>Success! And you’ll notice that the global code chunk options were applied to this code chunk as well*.</p>

<ul>
  <li>Note: As of November 2022, Quarto has not implemented global options for <code class="language-plaintext highlighter-rouge">results</code>. This will need to be added to each code chunk if needed until further notice.</li>
</ul>

<blockquote class="callout">
  <h2 id="tip-many-ways-to-run-external-code">Tip: Many ways to run external code</h2>
  <p>There are at least 3-4 methods one can use to run external code, the best choice may just depend on the context or on your personal preference. There’s no method that’s a clear winner, because there’s an awkward quirk or another to each of them, but better than copy/pasting code from elsewhere in your project (in our humble opinion):</p>

  <ol>
    <li>source()   – <a href="https://bookdown.org/yihui/rmarkdown-cookbook/source-script.html">see more at bookdown.org</a></li>
    <li>sys.source()   – <a href="https://bookdown.org/yihui/rmarkdown-cookbook/source-script.html">see more at bookdown.org</a></li>
    <li>knitr::read_chunk()  – <a href="https://stackoverflow.com/a/52398016">see more at stackoverflow</a></li>
  </ol>

</blockquote>

<blockquote class="challenge">
  <h2 id="challenge-83-your-turn-create-figure-4-with-the-external-code">Challenge 8.3: Your turn! Create Figure 4 with the external code</h2>

  <p>First, find <code class="language-plaintext highlighter-rouge">Example 9</code> in the qmd document for Fig 4 (ctrl-f “Example 9”). We need to add the code for the hormone analysis.</p>

  <p>Make sure to give the code chunk a name: <code class="language-plaintext highlighter-rouge">fig4-hormones</code> and a caption: <code class="language-plaintext highlighter-rouge">"Fig 4: Cortisol and Amylase levels in stress and control groups"</code></p>

  <blockquote class="solution">
    <h2 id="solution-2">Solution:</h2>
    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="n">r</span><span class="p">}</span><span class="w">
</span><span class="c1">#| label: fig4-hormones</span><span class="w">
</span><span class="c1">#| fig.cap: "Fig 4: Cortisol and Amylase levels in stress and control groups"</span><span class="w">
</span><span class="c1"># run the code from 02_hormone_analysis.R in the code directory</span><span class="w">
</span><span class="n">source</span><span class="p">(</span><span class="s2">"code/02_hormone_analysis.R"</span><span class="p">,</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">knitr</span><span class="o">::</span><span class="n">knit_global</span><span class="p">())</span><span class="w">
</span><span class="c1"># display the plot created by code in 02_hormone_analysis.R</span><span class="w">
</span><span class="n">plot</span><span class="w"> 
</span></code></pre></div>    </div>
  </blockquote>
</blockquote>

<blockquote class="checklist">
  <h2 id="time-to-commit">Time to Commit!</h2>
  <p>Now, let’s commit the changes you have made.</p>
</blockquote>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>renv is a handy tool for capturing your project’s package dependencies</p>
</li>
    
    <li><p>Learn how to externally source code <code class="language-plaintext highlighter-rouge">source()</code></p>
</li>
    
    <li><p>Learn how to modularize your code to make it more reproducible</p>
</li>
    
    <li><p>There are options for changing the working directory of your <code class="language-plaintext highlighter-rouge">.qmd</code> document with package <code class="language-plaintext highlighter-rouge">rprojroot</code></p>
</li>
    
    <li><p>Use a chunk at the beginning of your document to load libraries and data globally to make your document more efficient.</p>
</li>
    
  </ul>
</blockquote>

<hr />

<h1 id="bibliography-citations-cross-referencing" class="maintitle">Bibliography, Citations &amp; Cross-Referencing</h1>

<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 25 min
      <br />
      <strong>Exercises:</strong> 10 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How can you insert citations to your manuscripts using RStudio’s visual editor?</p>
</li>
	
	<li><p>How can you change citation styles?</p>
</li>
	
	<li><p>What are the options to display cited and uncited bibliography?</p>
</li>
	
	<li><p>How can you cross-reference content?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Inserting citations and listing bibliography in an Quarto Document file.</p>
</li>
	
	<li><p>Changing citation styles.</p>
</li>
	
	<li><p>Customizing how citations and bibliography are displayed.</p>
</li>
	
	<li><p>Add cross-referencing directing your readers through your document.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="why-citing">Why citing?</h2>

<p>Correctly citing and attributing publications is key to academic writing. Older versions of RStudio require <a href="https://pandoc.org/MANUAL.html#citation-syntax">Pandoc’s</a> citation syntax to render bibliographies correctly. We won’t be covering this approach extensively in this workshop, since the new visual editor has made this process much more simple. You can refer to our <a href="https://ucsbcarpentry.github.io/R-markdown/06-citations-bib/index.html">previous workshop on R Markdown</a> pre-visual editor for more information.</p>

<p>The new visual editor has made citations and cross-referencing much easier, by offering different options for referencing various types of sources. Before getting into these different features, let’s first learn how you can call the citation window dialog on Rstudio and how to navigate these different options.</p>

<h2 id="calling-citation-options-on-rstudio">Calling Citation Options on Rstudio</h2>

<p>After placing your cursor where you want to insert the citation you can either click the <code class="language-plaintext highlighter-rouge">@</code> icon in the toolbar, or select <code class="language-plaintext highlighter-rouge">Insert</code>, and from the drop down menu choose <code class="language-plaintext highlighter-rouge">Citation</code>. Alternatively you can use the keyboard shortcut <kbd>⇧⌘ F8</kbd> on Mac, or <kbd>Ctrl+Shift+F8</kbd> for Windows.</p>

<p><img src="../fig/09-insert-citation.png" alt="Citation Window" /></p>

<p>The citation window will display different options for inserting citations, You can either find items listed in your own sources through your Bibliography folder (you should have one already in your project folder provided by us), your Zotero Library(ies) if you have the reference manager installed in your computer, or even use the lookup feature to search for publications by DOI (Digital Object Identifier), Crossref, DataCite, or PubMed ID as we will explore a bit more shortly.</p>

<h2 id="understanding-how-rstudio-stores-and-organizes-citations">Understanding How Rstudio Stores and Organizes Citations</h2>

<p>Have you noticed that the YAML header contains “bibliography: references.bib”. Any idea why? Well, that’s because on our paper template we have some existing citations, and a references.bib file in our project folder. Rstudio adds that automatically to the YAML once you cite the first item to your manuscript. But let’s first open the references.bib file (located in report&gt;source on your project folder) and understand how citations are presented there:</p>

<p><img src="../fig/09-references-bib.png" alt="references.bib" /></p>

<p>A file with the BIB file extension is a BibTeX Bibliographical Database file. It’s a specially formatted text file that lists references pertaining to a particular source of information. They’re normally seen only with the .BIB file extension but might instead use .BIBTEX. BibTeX files might hold references for things like research papers, articles, books, etc. Included within the file is often an author name, year, title, page number, and other related content. Each item can be edited, in case there is any metadata incorrect or missing.</p>

<p>Most citation and reference management tools such as Refworks, Endnote, Mendeley and Zotero, as well as some search engines (e.g. Google Scholar), most scientific databases, and our UCSB library catalog allow us to export citations as .bib <a href="https://en.wikipedia.org/wiki/BibTeX">BibteX</a> files. These files are used to describe and process lists of references, mostly in conjunction with LaTeX documents. Each .bib file has a citation key or ID preceded by an <code class="language-plaintext highlighter-rouge">@</code>, which uniquely identifies each item. Citation keys can be customized as we will learn in a bit, but be advised that your manuscript will render citations correctly only if you have the cited item corresponding to its exact key.</p>

<h2 id="inserting-citations">Inserting Citations</h2>

<p>Note that we have different blocks in this file starting with a <code class="language-plaintext highlighter-rouge">@</code> and ending with a curly bracket <code class="language-plaintext highlighter-rouge">{</code>, each one representing a unique citable source. We will be adding now a new item using the DOI lookup function so that you can see how the magic works!</p>

<p>Let’s assume you want to include a citation in the first line of the Value of the Data section, because you would like to provide some reference of how the salivary cortisol technique has been used in research. So let’s click where we want to insert the citation, call the citation function and lookup for the following DOI: <a href="https://doi.org/10.1016/B978-012373947-6.00334-2">https://doi.org/10.1016/B978-012373947-6.00334-2</a></p>

<p><img src="../fig/09-salviary-cortisol.png" alt="Salviary Cortisol" /></p>

<p>The DOI lookup uses the <a href="https://www.library.ucsb.edu/sites/default/files/dls_n4_pids_navy.pdf">persistent identifier</a> which connects to the DOI resolver service and retrieves the .bibtex file with resource metadata<sup>1</sup>. You should insert the whole DOI address, including the resolver service, the prefix and the suffix which is specific to the resource as illustrated below:</p>

<p><img src="../fig/09-doi-lookup.png" alt="DOI Lookup" /></p>

<p>Rstudio will search the <a href="https://support.datacite.org/docs/doi-basics">DOI</a> API and list the only matching result and you can insert it. After confirming this is the citation you would like to include, you can modify the key, if you would like to simplify it, and also choose if you would like to insert it as a in-text citation, meaning you would like to have the last name of the author(s) followed by a page number enclosed in parentheses. i.e., Kirschbaum and Hellhammer (2007), but in this case, we will uncheck that option since we won’t include authors as part of the narrative. Instead we would like to insert a parenthetical citation, where authors and year will be displayed inside the parentheses such as (Kirschbaum and Hellhammer 2007). You may insert more than one citation by selecting multiple items.</p>

<p>This item will be automatically listed in your references.bib file and will help you manage your citations more efficiently. Pretty cool, huh? If you want to cite this same item again you can type <code class="language-plaintext highlighter-rouge">@</code> and the first letters of the item name which will be auto-completed by Rstudio. For parenthetical citations you will have to type the key between brackets and for in-text narrative citations, you only need to type in the key.
Note that when you hover over the citation, you will preview the full reference for the cited item that will be listed at the bottom of the manuscript. This feature helps you to identify if you have to edit anything in the .bib file your citation is calling. Also, note that all citations will be included at the end of your document under a reference list.</p>

<blockquote class="challenge">
  <h2 id="challenge-91---insert-a-citation-using-the-doi-lookup-function">Challenge 9.1 - Insert a Citation Using the DOI Lookup Function</h2>

  <p>Following the same process described,
insert a parenthetical citation to the publication “Welcome to the tidyverse”
(<a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>)
where there is a mention to this package in the data paper. Look for: <code class="language-plaintext highlighter-rouge">add citation here</code></p>

  <blockquote class="solution">
    <h2 id="solution">Solution</h2>
    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[@wickham2019]
render the document and voiala!
(Wickham et al., 2019)
</code></pre></div>    </div>

  </blockquote>
</blockquote>

<p>Inserting citations using Crossref, DataCite or PubMed follows a very similar process to the DOI process, however; to search on their APIs you will need to input information accordingly. For Crossref, you may use keywords and author information to identify an item (e.g., Cortisol Stress Oken) and Rstudio will connect to <a href="https://search.crossref.org/">Crossref search</a> and provide related results, often not as specific as the DOI search, for cases you know exactly what you are looking for. DataCite allows searches by persistent identifiers or keywords, while PubMed searches exclusively in biomedical literature indexed in the database. If you have the PMID (PubMed reference number), which is uniquely assigned by the NIH National Library of Medicine to papers indexed in PubMed, similarly to the DOI search, it will save you time.</p>

<h2 id="editing-metadata--citation-key">Editing Metadata &amp; Citation Key</h2>

<p>Not all citations are in perfect shape when we import them. You may have to adjust them (e.g., include missing metadata, move content to another metadata field). If needed, we can do so by modifying the .bib file. As briefly mentioned, you can also edit citation keys. By default, most citation keys will have the first author last name or the first word of the title (if no authors), followed by the year of publication. You may consider editing the citation key in case you want to simplify the entry and speed up the autocomplete option. If you choose to do so, you can simply click on the key in the .bib file and edit it. Please be advised to use this option with caution, and to update citations to match the .bib file.</p>

<h2 id="changing-citation-styles">Changing Citation Styles</h2>

<p>You might have noticed that all citations are inserted in a specific style. Can you guess which one? If you answered Chicago, that is correct! By default, Rstudio uses a Chicago author-date format for citations and references. To use another style, you will need to specify a CSL (Citation Style Language) file in the csl metadata field in the YAML.</p>

<p>But how can you identify which CSL you should use? You can find required formats on the <a href="https://www.zotero.org/styles">Zotero Style Repository</a>, which makes it easy to search for and download your desired style.</p>

<p>Download the format you wish to use and call it out in the YAML. We have pre-saved the APA CSL file in the project folder for you. But if you would like to follow the process or try another style, go to the Zotero Style repo and select <a href="https://www.zotero.org/styles/apa">American Psychological Association 7th edition</a> or any other style of your choice. You will notice that it will automatically download the file (e.g. <code class="language-plaintext highlighter-rouge">apa.csl</code>). Make sure to save it to your project directory in report/source folder. In the YAML we have to call the exact name of the file preceded by “csl:”</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>csl: apa.csl
</code></pre></div></div>

<p>Save and render the document to see how citations and references have changed. This same process could be followed for any citation style required by the university, the journal or conference you are planning to submit your manuscript to.</p>

<blockquote class="challenge">
  <h2 id="challenge-92---changing-the-citation-style">Challenge 9.2 - Changing the Citation Style</h2>

  <p>How can you go back to using Chicago Style?</p>

  <blockquote class="solution">
    <h2 id="solution-1">Solution:</h2>

    <p>You can either delete the csl information as it is set as the default, or call it in the YAML:</p>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>csl: chicago.csl
</code></pre></div>    </div>

  </blockquote>
</blockquote>

<h2 id="adding-items-to-the-references-without-citing-them">Adding Items to the References without Citing them</h2>

<p>All cited items will be listed under the section References which you created before while practicing headings and subheadings. Items will be placed automatically in alphabetical order for most citation styles. However, there might be cases that you will be referencing supporting literature which you have not necessarily cited in the document.</p>

<p>By default, the bibliography will only display items that are directly referenced in the document. If you want to include items in the bibliography without actually citing them in the body text, you can define a dummy nocite metadata field in the YAML and put the citations there.</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nocite: |
  @item1, @item2
</code></pre></div></div>

<p>To demonstrate that let’s include the bibtex <code class="language-plaintext highlighter-rouge">@key</code> for an item that was not cited in the YAML. Note that this will force all items added in the YAML with this command to be listed in the bibliography.</p>

<p>Let’s try!</p>

<blockquote class="challenge">
  <h2 id="challenge-93---adding-references-you-have-not-cited">Challenge 9.3 - Adding references you have not cited</h2>

  <p>We have used a few packages in our paper that we do not necessarily cite in text. However, it is a good practice to add them to the reference list. This practice is recommended for giving proper credit to package developers and also to inform your readers about the exact version you have used to produce your paper.</p>

  <p>Ideally we would follow this process for all packages we have installed and used to produce the paper. But for the sake of time, let’s do that process for the stringi package only.</p>

  <p>1) First, you would go to the <a href="https://cran.r-project.org/web/packages/stringi/index.html">CRAN page for stringi</a>, click on citation info link and copy the corresponding BibTeX entry. 
2) Paste the bibtex into the “references.bib” file, and ensure the new entry has the key <strong>stringi2022</strong>.</p>

  <p>Now that you have the citation info and know the key for the package is @stringi2022, how would you go about to add this bibliography as a no-cite?</p>

  <blockquote class="solution">
    <h2 id="solution-2">Solution</h2>

    <p>You should specify @stringi2022 in the nocite section of the YAML header:</p>

    <div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nocite: |
  @stringi2022
</code></pre></div>    </div>

  </blockquote>
</blockquote>

<blockquote class="checklist">
  <h2 id="important-info">Important Info:</h2>
  <p>Does the indentation matter? Yes, you have to indent at least one space and the citation key should turn green to work.<br />
In case you are including a citation to <code class="language-plaintext highlighter-rouge">nocite</code> that you have not cited in the document, you have to make sure first that the bib file is in your Bibliography folder.</p>
</blockquote>

<blockquote class="checklist">
  <h2 id="tip">Tip:</h2>
  <blockquote>
    <p>Depending on the bibliography style, BibTeX converts all characters in the title to lowercase, except for the first character. If you want to override this, wrap the character(s) you wish to show in upper case, in curly braces.</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>title = "Pascal, {C}, {Java}: were they all conceived in {ETH}?" 
</code></pre></div>    </div>
  </blockquote>
</blockquote>

<h2 id="adding-cross-referencing">Adding Cross-referencing</h2>

<p>Cross-referencing is a useful way of directing your readers through your document, and it can be accomplished in Quarto. You may create cross-references to figures, tables, equations, sections, code listings, theorems, proofs, and more.</p>

<p>Essentially, every cross-referenceable entity requires a caption (description), the object info, and a label (unique identifier. Let’s say we want to cross-reference Figure 1 in the paper. To do so, we will need to first create an id for it. If we are in the visual mode, we can double click the image, click the “Attributes” tab, and enter #fig1 as the ID.</p>

<p><img src="../fig/09-inserting-crossref.png" alt="Inserting cross-referencing" /> <br /></p>

<p>Alternatively, in the source mode, we can enter that same ID in front of the figure name, by typing in {#fig-fig1}</p>

<p><code class="language-plaintext highlighter-rouge">![Experimental timeline and measurements.](fig/Fig1.jpg){#fig-fig1}</code></p>

<p>Ok, but how can you call that in another part of the paper? You may enter the key below using the unique identifier, but instead of the hash <code class="language-plaintext highlighter-rouge">#</code> it should be preceeded by an at <code class="language-plaintext highlighter-rouge">@</code>:</p>

<p><code class="language-plaintext highlighter-rouge">@fig-fig1</code></p>

<p>If you do not start you label with <code class="language-plaintext highlighter-rouge">fig-</code>, Quarto will interpret it as a citation and won’t render correctly. Click <code class="language-plaintext highlighter-rouge">Render</code> and see how it displays.</p>

<p>You may follow a similar approach to add cross-references for sections <code class="language-plaintext highlighter-rouge">(#sec-)/(@sec-)</code>, equations  <code class="language-plaintext highlighter-rouge">(#eq-)/(@eq-)</code> and tables <code class="language-plaintext highlighter-rouge">(#tbl-)/(@tbl-)</code>. For more information on how to cross-reference different types of objects, visit <a href="https://quarto.org/docs/authoring/cross-references.html">Quarto - Cross References</a>.</p>

<p>If you wish to add a cross-reference to a figure that was generated via code block, you have to provide a label (id) and a caption at the beggining of the figure code block.</p>

<p>`
#| label: fig-id
#| fig-cap: “figure caption here” 
`
And then, enter the @fig-id where you want to note the cross-referece in your paper.</p>

<blockquote class="challenge">
  <h2 id="challenge-94---adding-cross-reference-for-code-block-figures">Challenge 9.4 - Adding cross-reference for code block figures</h2>
  <p>Your turn! Include a cross-reference to Figure 3. In a previous lesson we added a caption for figure 3: <code class="language-plaintext highlighter-rouge">fig-cap = "Fig 3: Mean heart rate of stress and control groups at baseline and during intervention.</code>. How we would have to tweek that a bit to make the cross-referencing render correctly?</p>

  <blockquote class="solution">
    <h2 id="solution-3">Solution:</h2>
    <p>1) Add a label (id) e.g. <code class="language-plaintext highlighter-rouge">#| label: fig-fig3</code>
2) Make sure the caption is correctly represented <code class="language-plaintext highlighter-rouge">#| fig-cap: "Fig 3: Mean heart rate of stress and control groups at baseline and during intervention"</code>
3) Call the figure using the assigned id <code class="language-plaintext highlighter-rouge">@fig-fig3</code></p>

    <p><strong>FIXME: Add screenshot</strong></p>

  </blockquote>
</blockquote>

<blockquote class="checklist">
  <h2 id="time-to-commit">Time to Commit!</h2>
  <p>Make sure to commit your changes with Git. Add your changed files and commit with the following message: “Added Bibliography”</p>
</blockquote>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Rstudio supports different lookups strategies to easy the citation process.</p>
</li>
    
    <li><p>Rstudio supports different citation styles.</p>
</li>
    
    <li><p>The YAML can be ajusted to display uncited items in the reference list.</p>
</li>
    
    <li><p>Use bookdown to cross-reference content.</p>
</li>
    
  </ul>
</blockquote>

<hr />

<h1 id="collaborating-via-github" class="maintitle">Collaborating via Github</h1>

<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 15 min
      <br />
      <strong>Exercises:</strong> 10 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How do I authenticate with Github?</p>
</li>
	
	<li><p>How do I put my project on Github?</p>
</li>
	
	<li><p>How do I "<em>push</em>" my latest changes to Github ?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Authenticate with Github.</p>
</li>
	
	<li><p>Connecting your project to Github.</p>
</li>
	
	<li><p>Make changes locally and push them to Github.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<div style="font-size: 150%; margin: 20px; border: solid 2px red;">Note: Instead of using this section, we will rely on <a href="https://github.com/GitCredentialManager/git-credential-manager/blob/release/docs/install.md">Git Credential Manager</a>. Windows users will have installed this when they installed Git for Windows. Mac users will need to install it separately.</div>

<p>In <a href="../05-setup-versioning/">episode 5</a> we learned about using version control as you write your publication.  In this part of the workshop we’ll setup Rstudio to authenticate with Github which is necessary to <em>push</em> your changes to Github.</p>

<p>Terminology:  Git <em>Push</em> and <em>Pull</em></p>

<p>Definition: The process of syncronizing your local git repository with your git repository on Github (or other Git server).</p>

<p>Github used to allow simple Username &amp; Password authentication but now Github requires a more secure method of authentication.  For this workshop we’ll be using the Personal Access Token method.  The Personal Access Token (PAT) must be created for your account on github.  You’ll use the PAT to authenticate instead of your Github account password.</p>

<ol>
  <li>Login to your Github account with your web browser. <a href="https://github.com">https://github.com</a></li>
  <li>On Github.com go to your account setting -&gt; Developer Settings -&gt; Personal access tokens or this link: <a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a></li>
  <li>Any tokens you have created in the past will be listed there and you can click “Generate new token” button.  Set an expiration date for your new token and a scope.  For this workshop the “Repo” scope should be sufficient.  Then Generate your new Token with the button at the bottom of the page.</li>
</ol>

<p><img src="../fig/10-github-new-PAT-options.png" alt="PAT options on GitHub" /></p>
<ul>
  <li>On the next screen github shows you the new token.  <strong>Be sure to copy it</strong> as you only get one chance to see the token text.</li>
</ul>

<blockquote class="callout">
  <h2 id="note">Note:</h2>

  <p>If you cloned the repository from Github in Episode 5 the next 2 steps are not necessary as the “origin” is set as part of the cloning process.</p>
</blockquote>

<h2 id="getting-your-repositorys-url-from-github">Getting your repository’s URL from Github</h2>
<p>You can get the address of your repository from Github by navigating to your repository on Github.com and clicking the green “Code” button.</p>

<p><img src="../fig/10-github-clone.png" alt="Copy Repo URL from GitHub" /></p>

<p>With that address you can complete setting the origin URL in the next step.</p>

<h2 id="checking-and-setting-the-origin-for-the-local-copy-of-your-repository">Checking and Setting the “Origin” for the local copy of your repository.</h2>

<p>If you forked and cloned the demonstration publication for this workshop as covered in an earlier episode then your copy of the repository should already have the “origin” set.  Once the “origin” is set properly you should be able to push and pull your changes to and from Github.  When you clone a repository from Github your local copy of the repository should have Github set as the “origin”.</p>

<p>You can check this in Rstudio –&gt; Tools –&gt; Project Options –&gt; Git/SVN</p>

<p>If the “Origin” field is blank then you’ll need to add it from the terminal with a couple of terminal commands like this:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git remote add origin &lt;paste your repository address here&gt;
git fetch --set-upstream origin main
</code></pre></div></div>

<p>Be sure <strong>your</strong> Github username is part of the URL.</p>

<p>After you’ve updated the Origin URL from the command line go back to R Studio –&gt; Tools –&gt; Project Options –&gt; Git/SVN to verify you have the “Origin” field filled in.  It should look like this.</p>

<p><img src="../fig/10-rstudio-project-options-git-with-https-origin.png" alt="RSTudio Project Options Git/SVN" /></p>

<h2 id="push-your-local-changes-up-to-your-repository-github">Push your local changes up to your repository Github.</h2>
<p>With authentication set up and your local copy of your repository pointing to Github as the “Origin” you should be able to make changes locally and <em>push</em> them up to Github.</p>

<p>When you are prompted enter your Github username and then paste in your Personal Access Token (PAT) when prompted for your github password.</p>

<p><img src="../fig/10-git-mac-password-prompt.png" alt="RStudio PAT Password Prompt" /></p>

<p>Let’s try it and see if it works.</p>

<blockquote class="challenge">
  <h2 id="challenge-push-to-github">Challenge: Push to Github</h2>

  <ol>
    <li>Make a change to one of the files in your project or add a new file.</li>
    <li>In R Studio’s Git panel check the box to Stage the changed file.</li>
    <li>Commit the change to your Git repository.</li>
    <li>Click the green up arrow to <em>Push</em> you repository changes up to Github.</li>
    <li>Look on <a href="https://github.com">Github.com</a> to verify your changes are there.</li>
  </ol>

</blockquote>

<p>With the ability to synchronize your changes between Github and your local the next step is explore options for publishing your research paper.</p>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Setting up R Studio to authenticate with Github using a Personal Authentication Token (PAT).</p>
</li>
    
    <li><p>Setting the Git repository <em>Origin</em> in your R Studio project enables <em>pushing</em> and <em>pulling</em> from your local copy of the repository to the repository on Github.</p>
</li>
    
  </ul>
</blockquote>

<hr />

<h1 id="publishing-your-project" class="maintitle">Publishing your project</h1>

<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 10 min
      <br />
      <strong>Exercises:</strong> 0 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>What are the options for you to publish your project?</p>
</li>
	
	<li><p>What free and open publishing resources are available?</p>
</li>
	
	<li><p>What aspects should guide your choice?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Identify different ways you can publish your project.</p>
</li>
	
	<li><p>Overview of some free and open resources available.</p>
</li>
	
	<li><p>Learn which factors should guide your decision-making process.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="what-is-next">What is Next?</h2>

<p>Once you have completed your Quarto manuscript following all the best practices for reproducibility, including organizing your project files, what is next?  The answer depends on your plans to move forward.  Let’s explore some scenarios:</p>

<h3 id="if-you-plan-to-share-your-insights-with-your-community-right-away">If you plan to share your insights with your community right away</h3>

<h4 id="publishing-with-rpubs">Publishing with Rpubs</h4>

<ul>
  <li>The easiest way would be to use <a href="https://rpubs.com/">Rpubs</a>, which is integrated with Rstudio. Rpubs is a bare-bones, free web hosting service created for the sole purpose of hosting R Markdown documents.  It provides no other services— no support for search, collaboration, persistent identifers, or versioning.  But, it is the simplest and most direct way of getting your R Markdown (and now Quarto) document published on the web directly from RStudio.  For a more full-featured hosting service consider GitHub and GitHub Pages, described later.</li>
</ul>

<p>Notice the circular blue “Publish” button in the upper right corner of your <em>Render</em> output.  Click this to publish to Rpubs.  This is where you’ll need an Rpubs account as mentioned in <a href="/setup.html">setup</a>
for this workshop.</p>

<p>Click the blue publish button</p>

<p><img src="../fig/11-publish-button-scrnshot-2.png" alt="Publish button in RStudio" /></p>

<p>If you click on the carrot, you might get the warning below:</p>

<p><code class="language-plaintext highlighter-rouge">** Installing R Package Dependencies for Publishing: 'packrat', 'rsconnect', 'markdown'
[1/3] Installing packrat...</code></p>

<p>Wait for the installation to be completed. If a little menu pops up, select “Publish Document…” and you’ll be presented with the following panels:</p>

<p><img src="../fig/11-r-studio-knit-publish-to-scrnshot.png" alt="Publish to RPubs or RStudio Connect" /></p>

<p>(The other option in the dialog box, RStudio Connect, is a standalone publishing platform for teams to share content.  It requires purchase to host and use.)</p>

<p><img src="../fig/11-r-studio-knit-publish-confirm-scrnshot.png" alt="Confirm Publish to RPubs" /></p>

<p>The first time you publish, RStudio will likely ask if you want to install some needed packages; say yes.  RStudio will then open up a web browser to allow you sign in to rpubs.com.</p>

<p>At the end of the publish process your paper will be live on the internet
with a URL similar to: <code class="language-plaintext highlighter-rouge">https://rpubs.com/yourname/678624</code></p>

<p>RStudio also saves an HTML version of your <em>knit</em> document to your local file system.  Look for it in the same directory as the Quarto file in your R-Studio project directory.  This html document is self-contained and highly portable.  Images are encoded directly into the HTML so you can easily move it to any web hosting you have available.</p>

<h4 id="publishing-with-quarto-pub">Publishing with Quarto Pub</h4>

<p><a href="https://quartopub.com/">Quarto Pub</a> is a free publishing service ideal for publishing blogs, course or project websites, books, presentations, and personal hobby sites developed in Quarto. All documents and sites published to Quarto Pub are publicly visible, so be mindful you should only publish content you wish to share publicly. Also, there is a limit of 100 MB per publication and a soft limit of 10 GB per month.</p>

<p>There are two approaches to publish content to Quarto Pub:</p>

<ol>
  <li>Use the <code class="language-plaintext highlighter-rouge">quarto publish command</code> to publish content rendered on your local machine</li>
</ol>

<p>or</p>

<ol>
  <li>If you are using GitHub, you can use a GitHub Action to automatically render your project and publish the resulting content whenever your code changes.</li>
</ol>

<p>As we are getting started we will cover briefly only the first approach. If you’d like to explore the second option, check <a href="https://quarto.org/docs/publishing/quarto-pub.html">Quarto Pub’s documentation</a>.</p>

<h5 id="publish-command">Publish Command</h5>

<ol>
  <li>From the directory where your project is located, execute the quarto publish command for Quarto Pub, type:</li>
</ol>

<p><code class="language-plaintext highlighter-rouge">quarto publish quarto-pub your-document.qmd</code></p>

<p>In our case, that would be <code class="language-plaintext highlighter-rouge">quarto publish quarto-pub DataPaper-ReproducibilityWorkshop.qmd</code>. But wait, first we have to ensure we are using the right path to call the document which is in the report folder. So, we can type in the terminal <code class="language-plaintext highlighter-rouge">cd report</code> before proceeding.</p>

<p><img src="../fig/11-quartopub-publishcommand.png" alt="Quarto Pub Publish command" /></p>

<ol>
  <li>
    <p>As it is our first time publishing in Quarto Pub the command above will prompt you to authenticate. We will need to confirm the authorization and create a Quarto Pub account to first.</p>
  </li>
  <li>
    <p>Then, you will be offered the option to change the document type if you’d like. And after the confirmation there will be some action on the terminal for rendering the document will be published in Quarto Pub.</p>
  </li>
</ol>

<p><img src="../fig/11-quartopub-publishexample.png" alt="Quarto Pub Publish Example" /> <br /></p>

<p>If there is time, we encourage you to try it yourself.</p>

<h4 id="publishing-as-website-on-github">Publishing as website on GitHub</h4>

<p>Another, better, but slightly more involved option for publishing a Quarto document on the web is to use GitHub and GitHub Pages.  We have already seen how RStudio has built-in support for pushing your RStudio project to GitHub.  To enable publishing to GitHub Pages, the website publication companion to GitHub, go to the Settings page of your repository on GitHub and select a branch (“branch” is a repository term) to publish.  Name your main Quarto file <code class="language-plaintext highlighter-rouge">index.qmd</code>, and render it to HTML as <code class="language-plaintext highlighter-rouge">index.html</code>.  With GitHub Pages enabled on your repository, the HTML file in your repository at https://github.com/myusername/myrepo/index.html will appear on the web as https://myusername.github.io/.</p>

<h4 id="other-document-types">Other document types</h4>

<p>When you create a new Quarto file in R Studio recall that you are presented with a choice of Output Formats:</p>

<p><img src="../fig/02-name-new-qmd.PNG" alt="RStudio output formats" /></p>

<p>For the purposes of this workshop we’ve been using HTML as the output format but other types are available.  You can render your Quarto as a document, a presentation or a <em>Shiny</em> app.  With the default installation of RStudio HTML output is most likely to work.  Other formats may require additional R packages and/or code libraries be installed on your computer.  RStudio also has a templating system to help with creating Quarto files with common elements, YAML metadata and rendering instructions.  This can be very helpful for example if you want to create a weekly or monthly report documenting an ongoing experiment, study or other changing data.</p>

<h3 id="if-you-are-willing-to-publish-your-manuscript-through-a-peer-reviewed-journal">If you are willing to publish your manuscript through a peer-reviewed journal</h3>
<ul>
  <li>Most journals now request the underlying data, code and documentation to be shared along with the manuscript, so in that case you will have that handy. Whenever possible, give preference to <em>open-access</em> journals with data sharing recommendations to foster open science, transparency and research reproducibility. The <a href="https://topfactor.org/journals">TOP Factor</a> allows you to search by journal title and/or discipline and will rank journals compliance with those principles.</li>
  <li>If your chosen journal does not require nor recommend a particular process for making your project data available (some will dictate what, where and how project data should be uploaded), you may still consider depositing your project files in a reliable data repository and cross-reference paper and project data, ideally with a formal citation containing a <a href="https://www.library.ucsb.edu/sites/default/files/dls_n4_pids_navy.pdf">Persistent Identifier</a>(e.g., DOI, ARK, handle, Purl) to avoid link rot.</li>
  <li>In terms of data repositories, there are many options available, and they can be disciplinary, institutional or generalist (e.g., Zenodo, Figshare). For a compreheensive list of options available please refer to the <a href="[https://www.re3data.org/">Registry of Research Data Repositories</a>. At UCSB Library we support <a href="https://datadryad.org/stash">Dryad</a>. If Dryad is not suitable for your needs, <a href="https://www.library.ucsb.edu/research-data-services">Research Data Services</a> can assist you finding a more optimal solution for archiving your project data.</li>
</ul>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>You may choose to share and publish your data project before publishing its associated manuscript.</p>
</li>
    
    <li><p>Sharing the code, data and documentation is necessary to allow for inspection and research reproducibility.</p>
</li>
    
  </ul>
</blockquote>

<hr />


</article>


      
      






<footer>
  <hr/>
  <div class="row">
    <div class="col-md-6 license" id="license-info" align="left">
	
        Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2023 by <a href="../CITATION">the authors</a>.
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	<a href="/edit//aio.md" data-checker-ignore>Edit on GitHub</a>
	
	/
	<a href="/blob//CONTRIBUTING.md" data-checker-ignore>Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob//CITATION" data-checker-ignore>Cite</a>
	/
	<a href="mailto:">Contact</a>
    </div>
  </div>
  <p class="text-muted text-right">
    <small><i>Using <a href="https://github.com/carpentries/carpentries-theme/">The Carpentries theme</a> &mdash; Site last built on: 2023-10-06 09:39:07 +1100.</i></small>
  </p>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>


<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
  _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io"]]);
  _paq.push(["setDoNotTrack", true]);
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://carpentries.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='//cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->


<script src="../assets/js/anchor.min.js"></script>
<script>
    anchors.add();
</script>

  </body>
</html>
